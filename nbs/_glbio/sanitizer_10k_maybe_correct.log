========= COMPUTE-SANITIZER
ccc_gpu
/mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all
/mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all
1
[PosixPath('/mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_whole_blood-var_pc_log2.pkl')]
/mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_whole_blood-var_pc_log2.pkl
test_data.shape: (56200, 755)
test_data.head():                     GTEX-111YS-0006-SM-5NQBE  ...  GTEX-ZXG5-0005-SM-57WCN
gene_ens_id                                   ...
ENSG00000169429.10                    0.5623  ...                  1163.00
ENSG00000135245.9                     0.6529  ...                   295.70
ENSG00000163631.16                    1.8480  ...                    17.75
ENSG00000277632.1                     1.6960  ...                   618.90
ENSG00000239839.6                   185.2000  ...                    63.85

[5 rows x 755 columns]
Device 0: "NVIDIA GeForce RTX 4090"
  CUDA Driver Version / Runtime Version          12.8 / 12.5
  CUDA Capability Major/Minor version number:    8.9
  Total amount of global memory:                 23.50 GBytes (25235423232 bytes)
  GPU Clock rate:                                2535 MHz (2.54 GHz)
  Memory Clock rate:                             10501 Mhz
  Memory Bus Width:                              384-bit
Free memory: 13.537659 GB, Total memory: 23.502319 GB

Debug Info:
  n_features: 10000
  n_partitions: 9
  n_objects: 755
  n_feature_comp: 49995000
  n_aris: 4049595000
  batch_n_aris: 1012297500

Allocating host memory...
  Memory before allocation: Host Memory Usage: 1899 MB (RSS), 64072 MB (Virtual)
  Memory after allocation: Host Memory Usage: 2090 MB (RSS), 64263 MB (Virtual)
  Memory used: 191 MB

Allocating device memory...
  max_batch_feature_comp: 12497500
  Memory before allocation: Free memory: 13.537659 GB, Total memory: 23.502319 GB
  Memory after allocation: Free memory: 13.488831 GB, Total memory: 23.502319 GB
  Memory used: 50 MB

Processing batch 1 of 5
  Start index: 0
  Batch size: 1012297500
  Memory before batch: Free memory: 13.488831 GB, Total memory: 23.502319 GB
  Current batch size: 1012297500

Memory before device allocations: Free memory: 13.488831 GB, Total memory: 23.502319 GB
Memory after device allocations: Free memory: 9.652893 GB, Total memory: 23.502319 GB
  Device memory used: 3928 MB
Memory before kernel launch: Free memory: 9.652893 GB, Total memory: 23.502319 GB
Memory after kernel launch: Free memory: 9.652893 GB, Total memory: 23.502319 GB
  Device memory used in kernel: 0 bytes
Debug: d_out->size() = 1012297500
  Launching reduction kernel with 12497500 blocks, 128 threads per block
  Memory after batch: Free memory: 9.717346 GB, Total memory: 23.502319 GB
  Memory used in batch: 3862 MB

Processing batch 2 of 5
  Start index: 1012297500
  Batch size: 1012297500
  Memory before batch: Free memory: 13.488831 GB, Total memory: 23.502319 GB
  Current batch size: 1012297500

Memory before device allocations: Free memory: 13.488831 GB, Total memory: 23.502319 GB
Memory after device allocations: Free memory: 9.652893 GB, Total memory: 23.502319 GB
  Device memory used: 3928 MB
Memory before kernel launch: Free memory: 9.652893 GB, Total memory: 23.502319 GB
Memory after kernel launch: Free memory: 9.652893 GB, Total memory: 23.502319 GB
  Device memory used in kernel: 0 bytes
Debug: d_out->size() = 1012297500
  Launching reduction kernel with 12497500 blocks, 128 threads per block
  Memory after batch: Free memory: 9.717346 GB, Total memory: 23.502319 GB
  Memory used in batch: 3862 MB

Processing batch 3 of 5
  Start index: 2024595000
  Batch size: 1012297500
  Memory before batch: Free memory: 13.488831 GB, Total memory: 23.502319 GB
  Current batch size: 1012297500

Memory before device allocations: Free memory: 13.488831 GB, Total memory: 23.502319 GB
Memory after device allocations: Free memory: 9.652893 GB, Total memory: 23.502319 GB
  Device memory used: 3928 MB
Memory before kernel launch: Free memory: 9.652893 GB, Total memory: 23.502319 GB
Memory after kernel launch: Free memory: 9.652893 GB, Total memory: 23.502319 GB
  Device memory used in kernel: 0 bytes
Debug: d_out->size() = 1012297500
  Launching reduction kernel with 12497500 blocks, 128 threads per block
  Memory after batch: Free memory: 9.717346 GB, Total memory: 23.502319 GB
  Memory used in batch: 3862 MB

Processing batch 4 of 5
  Start index: 3036892500
  Batch size: 1012297500
  Memory before batch: Free memory: 13.488831 GB, Total memory: 23.502319 GB
  Current batch size: 1012297500

Memory before device allocations: Free memory: 13.488831 GB, Total memory: 23.502319 GB
Memory after device allocations: Free memory: 9.652893 GB, Total memory: 23.502319 GB
  Device memory used: 3928 MB
Memory before kernel launch: Free memory: 9.652893 GB, Total memory: 23.502319 GB
Memory after kernel launch: Free memory: 9.652893 GB, Total memory: 23.502319 GB
  Device memory used in kernel: 0 bytes
Debug: d_out->size() = 1012297500
  Launching reduction kernel with 12497500 blocks, 128 threads per block
  Memory after batch: Free memory: 9.717346 GB, Total memory: 23.502319 GB
  Memory used in batch: 3862 MB

Processing batch 5 of 5
  Start index: 4049190000
  Batch size: 1012297500
  Memory before batch: Free memory: 13.488831 GB, Total memory: 23.502319 GB
  Current batch size: 405000

Memory before device allocations: Free memory: 13.488831 GB, Total memory: 23.502319 GB
Memory after device allocations: Free memory: 13.422424 GB, Total memory: 23.502319 GB
  Device memory used: 68 MB
Memory before kernel launch: Free memory: 13.422424 GB, Total memory: 23.502319 GB
Memory after kernel launch: Free memory: 13.422424 GB, Total memory: 23.502319 GB
  Device memory used in kernel: 0 bytes
Debug: d_out->size() = 405000
  Launching reduction kernel with 5000 blocks, 128 threads per block
  Memory after batch: Free memory: 13.486877 GB, Total memory: 23.502319 GB
  Memory used in batch: 2 MB
6333.492361783981
========= ERROR SUMMARY: 0 errors
