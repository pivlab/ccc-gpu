2025-07-10 20:52:38,753 - __main__ - INFO - Logging initialized. Base log directory: /home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs
2025-07-10 20:52:38,753 - __main__ - INFO - Timestamped log directory: /home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs/run_2025-07-10_20-52-38
2025-07-10 20:52:38,753 - __main__ - INFO - Log file: /home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs/run_2025-07-10_20-52-38/combine_coefs_1tissues_var_pc_log2.log
2025-07-10 20:52:38,753 - __main__ - INFO - Starting combine coefficients CLI tool
2025-07-10 20:52:38,753 - __main__ - INFO - Configuration: Config(top_n_genes='all', data_dir=PosixPath('/mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8'), include_patterns=['kidney_medulla'], exclude_patterns=None, gene_selection_strategy='var_pc_log2', log_level='INFO', log_dir=PosixPath('/home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs'), temp_dir=PosixPath('/mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache'), save_cache=False)
2025-07-10 20:52:38,753 - __main__ - INFO - This run's logs will be stored in: /home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs/run_2025-07-10_20-52-38
2025-07-10 20:52:38,753 - __main__ - INFO - Gene selection directory: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all
2025-07-10 20:52:38,753 - __main__ - INFO - Similarity matrices directory: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all
2025-07-10 20:52:38,753 - __main__ - INFO - Temporary directory: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache
2025-07-10 20:52:38,753 - __main__ - INFO - Selected tissues: ['kidney_medulla']
2025-07-10 20:52:38,753 - __main__ - INFO - Cache saving disabled - will not save intermediate cache files (default behavior)
2025-07-10 20:52:38,753 - __main__ - INFO - Starting correlation combination workflow
2025-07-10 20:52:38,753 - __main__ - INFO - Processing 1 tissues: ['kidney_medulla']
2025-07-10 20:52:38,753 - __main__ - INFO - Loading gene mapping...
2025-07-10 20:52:38,861 - __main__ - INFO - Loaded 56200 gene mappings
2025-07-10 20:52:38,861 - __main__ - INFO - === Processing tissue 1/1: kidney_medulla ===
2025-07-10 20:52:38,866 - __main__ - INFO - All input files validated successfully for kidney_medulla
2025-07-10 20:52:38,866 - __main__ - INFO - Starting correlation combination process for kidney_medulla
2025-07-10 20:52:38,866 - __main__ - INFO - Loading gene expression data for kidney_medulla from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_kidney_medulla-var_pc_log2.pkl
2025-07-10 20:52:39,164 - __main__ - INFO - Loaded gene expression data for kidney_medulla with shape: (56200, 4)
2025-07-10 20:52:39,164 - __main__ - INFO - Need to load and process for kidney_medulla: ccc_gpu, pearson, spearman
2025-07-10 20:52:39,164 - __main__ - INFO - No cache found for spearman in kidney_medulla, loading and processing matrix
2025-07-10 20:52:39,164 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_kidney_medulla-var_pc_log2-spearman.pkl
2025-07-10 20:53:03,760 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-10 20:53:11,394 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-10 20:53:11,396 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-10 20:53:11,396 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-10 20:55:10,115 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-10 20:55:10,117 - __main__ - INFO - Processed spearman correlation matrix to series with 692459505 values (dtype: float16)
2025-07-10 20:55:10,131 - __main__ - INFO - Processed spearman matrix for kidney_medulla (reference):
2025-07-10 20:55:10,131 - __main__ - INFO -   Shape: (692459505,)
2025-07-10 20:55:10,131 - __main__ - INFO -   Data type: float16
2025-07-10 20:55:14,378 - __main__ - INFO -   Memory usage: 6615.80 MB
2025-07-10 20:55:14,378 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-10 20:55:14,378 - __main__ - INFO - Cache saving disabled - not saving aligned spearman matrix for kidney_medulla
2025-07-10 20:55:14,638 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-10 20:55:14,638 - __main__ - INFO - Using Spearman indices as reference for kidney_medulla: 692459505 gene pairs
2025-07-10 20:55:14,638 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-10 20:55:14,639 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_kidney_medulla-var_pc_log2-ccc_gpu.pkl
2025-07-10 20:55:38,781 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-10 20:55:51,196 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-10 20:55:51,197 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-10 20:55:51,198 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-10 20:58:03,601 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1572177445 values (dtype: float16)
2025-07-10 20:58:03,615 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-10 20:58:03,615 - __main__ - INFO -   Original shape: (1572177445,)
2025-07-10 20:58:03,615 - __main__ - INFO -   Data type: float16
2025-07-10 20:58:13,253 - __main__ - INFO -   Memory usage: 15005.44 MB
2025-07-10 21:02:57,734 - __main__ - INFO - Alignment summary:
2025-07-10 21:02:57,734 - __main__ - INFO -   Aligned shape: (692459505,)
2025-07-10 21:02:57,734 - __main__ - INFO -   Alignment ratio: 44.04% of original
2025-07-10 21:03:01,965 - __main__ - INFO -   Memory saved: 41413.64 MB
2025-07-10 21:03:01,965 - __main__ - INFO - Cache saving disabled - not saving aligned ccc_gpu matrix for kidney_medulla
2025-07-10 21:03:02,220 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-10 21:03:05,245 - __main__ - INFO - Got aligned ccc_gpu series for kidney_medulla with 692459505 values
2025-07-10 21:03:05,245 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-10 21:03:05,245 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_kidney_medulla-var_pc_log2-pearson.pkl
2025-07-10 21:05:11,870 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-10 21:05:19,274 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-10 21:05:19,275 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-10 21:05:19,276 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-10 21:08:00,325 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-10 21:08:00,325 - __main__ - INFO - Processed pearson correlation matrix to series with 692459505 values (dtype: float16)
2025-07-10 21:08:00,339 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-10 21:08:00,339 - __main__ - INFO -   Original shape: (692459505,)
2025-07-10 21:08:00,339 - __main__ - INFO -   Data type: float16
2025-07-10 21:08:04,576 - __main__ - INFO -   Memory usage: 6615.80 MB
2025-07-10 21:11:26,970 - __main__ - INFO - Alignment summary:
2025-07-10 21:11:26,970 - __main__ - INFO -   Aligned shape: (692459505,)
2025-07-10 21:11:26,970 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-10 21:11:31,207 - __main__ - INFO -   Memory saved: 16512.00 MB
2025-07-10 21:11:31,207 - __main__ - INFO - Cache saving disabled - not saving aligned pearson matrix for kidney_medulla
2025-07-10 21:11:31,459 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-10 21:11:32,955 - __main__ - INFO - Got aligned pearson series for kidney_medulla with 692459505 values
2025-07-10 21:11:32,955 - __main__ - INFO - Combining 692459505 gene pairs for kidney_medulla
2025-07-10 21:14:42,674 - __main__ - INFO - Successfully combined correlations for kidney_medulla into DataFrame with shape: (692459505, 3)
2025-07-10 21:14:42,675 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 9257.3MB
2025-07-10 21:14:42,806 - __main__ - INFO - Saving combined correlations for kidney_medulla to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_kidney_medulla-var_pc_log2-all.pkl
2025-07-10 21:14:42,806 - __main__ - INFO - Saving DataFrame with shape: (692459505, 3), memory: 9257.3MB
2025-07-10 21:14:42,806 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-10 21:14:50,331 - __main__ - INFO - Results saved successfully. File size: 9246.7MB
2025-07-10 21:14:50,331 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-10 21:14:50,331 - __main__ - INFO - Successfully processed tissue 1/1: kidney_medulla
2025-07-10 21:14:50,331 - __main__ - INFO - Tissue processing time: 22.2 minutes
2025-07-10 21:14:50,331 - __main__ - INFO - === CORRELATION COMBINATION WORKFLOW COMPLETED ===
2025-07-10 21:14:50,331 - __main__ - INFO - Total processing time: 22.2 minutes (0.4 hours)
2025-07-10 21:14:50,331 - __main__ - INFO - Total tissues selected: 1
2025-07-10 21:14:50,331 - __main__ - INFO - Processed tissues (1): ['kidney_medulla']
2025-07-10 21:14:50,331 - __main__ - INFO - Average processing time per tissue: 22.2 minutes
2025-07-10 21:14:50,331 - __main__ - INFO - Success rate: 100.0% (1/1 tissues)
2025-07-10 21:14:50,367 - __main__ - INFO - CLI tool completed successfully
2025-07-10 21:14:50,367 - __main__ - INFO - Logs for this run saved in: /home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs/run_2025-07-10_20-52-38
