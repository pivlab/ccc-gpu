2025-07-03 00:39:15,792 - __main__ - INFO - Logging initialized. Base log directory: /home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs
2025-07-03 00:39:15,792 - __main__ - INFO - Timestamped log directory: /home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs/run_2025-07-03_00-39-15
2025-07-03 00:39:15,792 - __main__ - INFO - Log file: /home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs/run_2025-07-03_00-39-15/combine_coefs_54tissues_var_pc_log2.log
2025-07-03 00:39:15,792 - __main__ - INFO - Starting combine coefficients CLI tool
2025-07-03 00:39:15,792 - __main__ - INFO - Configuration: Config(top_n_genes='all', data_dir=PosixPath('/mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8'), include_patterns=None, exclude_patterns=None, gene_selection_strategy='var_pc_log2', log_level='INFO', log_dir=PosixPath('/home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs'), temp_dir=PosixPath('/mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache'))
2025-07-03 00:39:15,792 - __main__ - INFO - This run's logs will be stored in: /home/haoyu/_database/projs/ccc-gpu/nbs/03-manuscript/10_combine_coefs/logs/run_2025-07-03_00-39-15
2025-07-03 00:39:15,792 - __main__ - INFO - Gene selection directory: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all
2025-07-03 00:39:15,792 - __main__ - INFO - Similarity matrices directory: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all
2025-07-03 00:39:15,792 - __main__ - INFO - Temporary directory: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache
2025-07-03 00:39:15,792 - __main__ - INFO - Selected tissues: ['adipose_subcutaneous', 'adipose_visceral_omentum', 'adrenal_gland', 'artery_aorta', 'artery_coronary', 'artery_tibial', 'bladder', 'brain_amygdala', 'brain_anterior_cingulate_cortex_ba24', 'brain_caudate_basal_ganglia', 'brain_cerebellar_hemisphere', 'brain_cerebellum', 'brain_cortex', 'brain_frontal_cortex_ba9', 'brain_hippocampus', 'brain_hypothalamus', 'brain_nucleus_accumbens_basal_ganglia', 'brain_putamen_basal_ganglia', 'brain_spinal_cord_cervical_c1', 'brain_substantia_nigra', 'breast_mammary_tissue', 'cells_cultured_fibroblasts', 'cells_ebvtransformed_lymphocytes', 'cervix_ectocervix', 'cervix_endocervix', 'colon_sigmoid', 'colon_transverse', 'esophagus_gastroesophageal_junction', 'esophagus_mucosa', 'esophagus_muscularis', 'fallopian_tube', 'heart_atrial_appendage', 'heart_left_ventricle', 'kidney_cortex', 'kidney_medulla', 'liver', 'lung', 'minor_salivary_gland', 'muscle_skeletal', 'nerve_tibial', 'ovary', 'pancreas', 'pituitary', 'prostate', 'skin_not_sun_exposed_suprapubic', 'skin_sun_exposed_lower_leg', 'small_intestine_terminal_ileum', 'spleen', 'stomach', 'testis', 'thyroid', 'uterus', 'vagina', 'whole_blood']
2025-07-03 00:39:15,792 - __main__ - INFO - Starting correlation combination workflow
2025-07-03 00:39:15,792 - __main__ - INFO - Processing 54 tissues: ['adipose_subcutaneous', 'adipose_visceral_omentum', 'adrenal_gland', 'artery_aorta', 'artery_coronary', 'artery_tibial', 'bladder', 'brain_amygdala', 'brain_anterior_cingulate_cortex_ba24', 'brain_caudate_basal_ganglia', 'brain_cerebellar_hemisphere', 'brain_cerebellum', 'brain_cortex', 'brain_frontal_cortex_ba9', 'brain_hippocampus', 'brain_hypothalamus', 'brain_nucleus_accumbens_basal_ganglia', 'brain_putamen_basal_ganglia', 'brain_spinal_cord_cervical_c1', 'brain_substantia_nigra', 'breast_mammary_tissue', 'cells_cultured_fibroblasts', 'cells_ebvtransformed_lymphocytes', 'cervix_ectocervix', 'cervix_endocervix', 'colon_sigmoid', 'colon_transverse', 'esophagus_gastroesophageal_junction', 'esophagus_mucosa', 'esophagus_muscularis', 'fallopian_tube', 'heart_atrial_appendage', 'heart_left_ventricle', 'kidney_cortex', 'kidney_medulla', 'liver', 'lung', 'minor_salivary_gland', 'muscle_skeletal', 'nerve_tibial', 'ovary', 'pancreas', 'pituitary', 'prostate', 'skin_not_sun_exposed_suprapubic', 'skin_sun_exposed_lower_leg', 'small_intestine_terminal_ileum', 'spleen', 'stomach', 'testis', 'thyroid', 'uterus', 'vagina', 'whole_blood']
2025-07-03 00:39:15,792 - __main__ - INFO - Loading gene mapping...
2025-07-03 00:39:15,921 - __main__ - INFO - Loaded 56200 gene mappings
2025-07-03 00:39:15,921 - __main__ - INFO - Processing tissue: adipose_subcutaneous
2025-07-03 00:39:15,921 - __main__ - INFO - Output file already exists for adipose_subcutaneous: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_adipose_subcutaneous-var_pc_log2-all.pkl
2025-07-03 00:39:15,921 - __main__ - INFO - File size: 19494.8MB
2025-07-03 00:39:15,921 - __main__ - INFO - Skipping adipose_subcutaneous - result already exists
2025-07-03 00:39:15,921 - __main__ - INFO - Processing tissue: adipose_visceral_omentum
2025-07-03 00:39:15,921 - __main__ - INFO - All input files validated successfully for adipose_visceral_omentum
2025-07-03 00:39:15,921 - __main__ - INFO - Starting correlation combination process for adipose_visceral_omentum
2025-07-03 00:39:15,921 - __main__ - INFO - Loading gene expression data for adipose_visceral_omentum from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_adipose_visceral_omentum-var_pc_log2.pkl
2025-07-03 00:39:16,368 - __main__ - INFO - Loaded gene expression data for adipose_visceral_omentum with shape: (56200, 541)
2025-07-03 00:39:16,369 - __main__ - INFO - Need to load and process for adipose_visceral_omentum: ccc_gpu, pearson, spearman
2025-07-03 00:39:16,369 - __main__ - INFO - No cache found for spearman in adipose_visceral_omentum, loading and processing matrix
2025-07-03 00:39:16,369 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_adipose_visceral_omentum-var_pc_log2-spearman.pkl
2025-07-03 00:39:45,016 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 00:39:52,744 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 00:39:52,747 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 00:39:52,747 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 00:41:29,351 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 00:41:29,351 - __main__ - INFO - Processed spearman correlation matrix to series with 1440046611 values (dtype: float16)
2025-07-03 00:41:29,364 - __main__ - INFO - Processed spearman matrix for adipose_visceral_omentum (reference):
2025-07-03 00:41:29,364 - __main__ - INFO -   Shape: (1440046611,)
2025-07-03 00:41:29,364 - __main__ - INFO -   Data type: float16
2025-07-03 00:41:38,216 - __main__ - INFO -   Memory usage: 13745.34 MB
2025-07-03 00:41:38,216 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 00:41:38,216 - __main__ - INFO - Caching aligned spearman matrix for adipose_visceral_omentum:
2025-07-03 00:41:38,216 - __main__ - INFO -   Shape: (1440046611,)
2025-07-03 00:41:38,216 - __main__ - INFO -   Data type: float16
2025-07-03 00:41:38,222 - __main__ - INFO -   Memory usage: 13745.34 MB
2025-07-03 00:41:46,906 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 00:42:15,033 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 00:42:15,034 - __main__ - INFO -   First 5 values:
2025-07-03 00:42:15,034 - __main__ - INFO -     ('ENSG00000179914.4', 'ENSG00000129824.15'): 0.285645
2025-07-03 00:42:15,034 - __main__ - INFO -     ('ENSG00000125740.13', 'ENSG00000129824.15'): 0.341309
2025-07-03 00:42:15,034 - __main__ - INFO -     ('ENSG00000125740.13', 'ENSG00000179914.4'): 0.165649
2025-07-03 00:42:15,034 - __main__ - INFO -     ('ENSG00000108342.12', 'ENSG00000129824.15'): 0.309570
2025-07-03 00:42:15,034 - __main__ - INFO -     ('ENSG00000108342.12', 'ENSG00000179914.4'): 0.305176
2025-07-03 00:42:15,034 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 00:42:15,034 - __main__ - INFO -   Index names: [None, None]
2025-07-03 00:42:43,837 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_adipose_visceral_omentum_var_pc_log2.pkl
2025-07-03 00:42:43,838 - __main__ - INFO -   Cache file size: 24721.39 MB
2025-07-03 00:42:44,082 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 00:42:44,082 - __main__ - INFO - Using Spearman indices as reference for adipose_visceral_omentum: 1440046611 gene pairs
2025-07-03 00:42:44,082 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 00:42:44,082 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_adipose_visceral_omentum-var_pc_log2-ccc_gpu.pkl
2025-07-03 00:44:11,682 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 00:44:35,432 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 00:44:35,433 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 00:44:35,433 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 00:46:05,861 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578600831 values (dtype: float16)
2025-07-03 00:46:05,875 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 00:46:05,875 - __main__ - INFO -   Original shape: (1578600831,)
2025-07-03 00:46:05,875 - __main__ - INFO -   Data type: float16
2025-07-03 00:46:15,379 - __main__ - INFO -   Memory usage: 15066.70 MB
2025-07-03 00:53:19,071 - __main__ - INFO - Alignment summary:
2025-07-03 00:53:19,071 - __main__ - INFO -   Aligned shape: (1440046611,)
2025-07-03 00:53:19,071 - __main__ - INFO -   Alignment ratio: 91.22% of original
2025-07-03 00:53:27,911 - __main__ - INFO -   Memory saved: 34345.36 MB
2025-07-03 00:53:27,911 - __main__ - INFO - Caching aligned ccc_gpu matrix for adipose_visceral_omentum:
2025-07-03 00:53:27,912 - __main__ - INFO -   Shape: (1440046611,)
2025-07-03 00:53:27,912 - __main__ - INFO -   Data type: float16
2025-07-03 00:53:27,918 - __main__ - INFO -   Memory usage: 13745.34 MB
2025-07-03 00:53:36,606 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 00:54:42,767 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 00:54:42,767 - __main__ - INFO -   First 5 values:
2025-07-03 00:54:42,767 - __main__ - INFO -     ('ENSG00000179914.4', 'ENSG00000129824.15'): 0.051636
2025-07-03 00:54:42,767 - __main__ - INFO -     ('ENSG00000125740.13', 'ENSG00000129824.15'): 0.102112
2025-07-03 00:54:42,767 - __main__ - INFO -     ('ENSG00000125740.13', 'ENSG00000179914.4'): 0.049927
2025-07-03 00:54:42,767 - __main__ - INFO -     ('ENSG00000108342.12', 'ENSG00000129824.15'): 0.076172
2025-07-03 00:54:42,767 - __main__ - INFO -     ('ENSG00000108342.12', 'ENSG00000179914.4'): 0.068115
2025-07-03 00:54:42,767 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 00:54:42,767 - __main__ - INFO -   Index names: [None, None]
2025-07-03 00:55:10,240 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_adipose_visceral_omentum_var_pc_log2.pkl
2025-07-03 00:55:10,240 - __main__ - INFO -   Cache file size: 24721.39 MB
2025-07-03 00:55:10,488 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 00:55:13,211 - __main__ - INFO - Got aligned ccc_gpu series for adipose_visceral_omentum with 1440046611 values
2025-07-03 00:55:13,211 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 00:55:13,212 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_adipose_visceral_omentum-var_pc_log2-pearson.pkl
2025-07-03 00:57:07,620 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 00:57:15,235 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 00:57:15,236 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 00:57:15,237 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 00:59:39,208 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 00:59:39,209 - __main__ - INFO - Processed pearson correlation matrix to series with 1440046611 values (dtype: float16)
2025-07-03 00:59:39,224 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 00:59:39,224 - __main__ - INFO -   Original shape: (1440046611,)
2025-07-03 00:59:39,224 - __main__ - INFO -   Data type: float16
2025-07-03 00:59:48,076 - __main__ - INFO -   Memory usage: 13745.34 MB
2025-07-03 01:06:37,014 - __main__ - INFO - Alignment summary:
2025-07-03 01:06:37,014 - __main__ - INFO -   Aligned shape: (1440046611,)
2025-07-03 01:06:37,014 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 01:06:45,896 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 01:06:45,896 - __main__ - INFO - Caching aligned pearson matrix for adipose_visceral_omentum:
2025-07-03 01:06:45,896 - __main__ - INFO -   Shape: (1440046611,)
2025-07-03 01:06:45,896 - __main__ - INFO -   Data type: float16
2025-07-03 01:06:45,902 - __main__ - INFO -   Memory usage: 13745.34 MB
2025-07-03 01:06:54,573 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 01:07:23,909 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 01:07:23,909 - __main__ - INFO -   First 5 values:
2025-07-03 01:07:23,909 - __main__ - INFO -     ('ENSG00000179914.4', 'ENSG00000129824.15'): 0.238892
2025-07-03 01:07:23,909 - __main__ - INFO -     ('ENSG00000125740.13', 'ENSG00000129824.15'): 0.219727
2025-07-03 01:07:23,909 - __main__ - INFO -     ('ENSG00000125740.13', 'ENSG00000179914.4'): 0.158569
2025-07-03 01:07:23,910 - __main__ - INFO -     ('ENSG00000108342.12', 'ENSG00000129824.15'): 0.083618
2025-07-03 01:07:23,910 - __main__ - INFO -     ('ENSG00000108342.12', 'ENSG00000179914.4'): 0.179932
2025-07-03 01:07:23,910 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 01:07:23,910 - __main__ - INFO -   Index names: [None, None]
2025-07-03 01:07:51,593 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_adipose_visceral_omentum_var_pc_log2.pkl
2025-07-03 01:07:51,593 - __main__ - INFO -   Cache file size: 24721.39 MB
2025-07-03 01:07:51,844 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 01:07:54,850 - __main__ - INFO - Got aligned pearson series for adipose_visceral_omentum with 1440046611 values
2025-07-03 01:07:54,850 - __main__ - INFO - Combining 1440046611 gene pairs for adipose_visceral_omentum
2025-07-03 01:14:22,962 - __main__ - INFO - Successfully combined correlations for adipose_visceral_omentum into DataFrame with shape: (1440046611, 3)
2025-07-03 01:14:22,963 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 19238.7MB
2025-07-03 01:14:23,378 - __main__ - INFO - Saving combined correlations for adipose_visceral_omentum to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_adipose_visceral_omentum-var_pc_log2-all.pkl
2025-07-03 01:14:23,378 - __main__ - INFO - Saving DataFrame with shape: (1440046611, 3), memory: 19238.7MB
2025-07-03 01:14:23,378 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 01:14:32,958 - __main__ - INFO - Results saved successfully. File size: 19228.0MB
2025-07-03 01:14:32,958 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 01:14:32,958 - __main__ - INFO - Successfully processed tissue: adipose_visceral_omentum
2025-07-03 01:14:32,958 - __main__ - INFO - Processing tissue: adrenal_gland
2025-07-03 01:14:32,958 - __main__ - INFO - All input files validated successfully for adrenal_gland
2025-07-03 01:14:32,959 - __main__ - INFO - Starting correlation combination process for adrenal_gland
2025-07-03 01:14:32,959 - __main__ - INFO - Loading gene expression data for adrenal_gland from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_adrenal_gland-var_pc_log2.pkl
2025-07-03 01:14:33,151 - __main__ - INFO - Loaded gene expression data for adrenal_gland with shape: (56200, 258)
2025-07-03 01:14:33,151 - __main__ - INFO - Need to load and process for adrenal_gland: ccc_gpu, pearson, spearman
2025-07-03 01:14:33,152 - __main__ - INFO - No cache found for spearman in adrenal_gland, loading and processing matrix
2025-07-03 01:14:33,152 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_adrenal_gland-var_pc_log2-spearman.pkl
2025-07-03 01:15:18,472 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 01:15:25,983 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 01:15:25,985 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 01:15:25,985 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 01:17:33,667 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 01:17:33,667 - __main__ - INFO - Processed spearman correlation matrix to series with 1358012670 values (dtype: float16)
2025-07-03 01:17:33,681 - __main__ - INFO - Processed spearman matrix for adrenal_gland (reference):
2025-07-03 01:17:33,681 - __main__ - INFO -   Shape: (1358012670,)
2025-07-03 01:17:33,681 - __main__ - INFO -   Data type: float16
2025-07-03 01:17:42,026 - __main__ - INFO -   Memory usage: 12963.01 MB
2025-07-03 01:17:42,026 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 01:17:42,026 - __main__ - INFO - Caching aligned spearman matrix for adrenal_gland:
2025-07-03 01:17:42,026 - __main__ - INFO -   Shape: (1358012670,)
2025-07-03 01:17:42,026 - __main__ - INFO -   Data type: float16
2025-07-03 01:17:42,032 - __main__ - INFO -   Memory usage: 12963.01 MB
2025-07-03 01:17:50,144 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 01:18:15,088 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 01:18:15,088 - __main__ - INFO -   First 5 values:
2025-07-03 01:18:15,089 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000100604.12'): 0.125854
2025-07-03 01:18:15,089 - __main__ - INFO -     ('ENSG00000134184.12', 'ENSG00000100604.12'): 0.016357
2025-07-03 01:18:15,089 - __main__ - INFO -     ('ENSG00000134184.12', 'ENSG00000129824.15'): 0.055420
2025-07-03 01:18:15,089 - __main__ - INFO -     ('ENSG00000180176.14', 'ENSG00000100604.12'): 0.965332
2025-07-03 01:18:15,089 - __main__ - INFO -     ('ENSG00000180176.14', 'ENSG00000129824.15'): 0.152344
2025-07-03 01:18:15,089 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 01:18:15,089 - __main__ - INFO -   Index names: [None, None]
2025-07-03 01:18:26,666 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_adrenal_gland_var_pc_log2.pkl
2025-07-03 01:18:26,666 - __main__ - INFO -   Cache file size: 23313.19 MB
2025-07-03 01:18:26,914 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 01:18:26,914 - __main__ - INFO - Using Spearman indices as reference for adrenal_gland: 1358012670 gene pairs
2025-07-03 01:18:26,914 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 01:18:26,915 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_adrenal_gland-var_pc_log2-ccc_gpu.pkl
2025-07-03 01:18:50,642 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 01:19:08,115 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 01:19:08,117 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 01:19:08,117 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 01:22:14,092 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578205055 values (dtype: float16)
2025-07-03 01:22:14,107 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 01:22:14,108 - __main__ - INFO -   Original shape: (1578205055,)
2025-07-03 01:22:14,108 - __main__ - INFO -   Data type: float16
2025-07-03 01:22:23,728 - __main__ - INFO -   Memory usage: 15062.92 MB
2025-07-03 01:29:03,992 - __main__ - INFO - Alignment summary:
2025-07-03 01:29:03,992 - __main__ - INFO -   Aligned shape: (1358012670,)
2025-07-03 01:29:03,992 - __main__ - INFO -   Alignment ratio: 86.05% of original
2025-07-03 01:29:12,254 - __main__ - INFO -   Memory saved: 35123.92 MB
2025-07-03 01:29:12,255 - __main__ - INFO - Caching aligned ccc_gpu matrix for adrenal_gland:
2025-07-03 01:29:12,255 - __main__ - INFO -   Shape: (1358012670,)
2025-07-03 01:29:12,255 - __main__ - INFO -   Data type: float16
2025-07-03 01:29:12,261 - __main__ - INFO -   Memory usage: 12963.01 MB
2025-07-03 01:29:20,418 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 01:30:16,492 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 01:30:16,492 - __main__ - INFO -   First 5 values:
2025-07-03 01:30:16,492 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000100604.12'): 0.017868
2025-07-03 01:30:16,492 - __main__ - INFO -     ('ENSG00000134184.12', 'ENSG00000100604.12'): 0.004391
2025-07-03 01:30:16,492 - __main__ - INFO -     ('ENSG00000134184.12', 'ENSG00000129824.15'): 0.009109
2025-07-03 01:30:16,492 - __main__ - INFO -     ('ENSG00000180176.14', 'ENSG00000100604.12'): 0.793945
2025-07-03 01:30:16,492 - __main__ - INFO -     ('ENSG00000180176.14', 'ENSG00000129824.15'): 0.016876
2025-07-03 01:30:16,493 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 01:30:16,493 - __main__ - INFO -   Index names: [None, None]
2025-07-03 01:30:42,411 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_adrenal_gland_var_pc_log2.pkl
2025-07-03 01:30:42,411 - __main__ - INFO -   Cache file size: 23313.19 MB
2025-07-03 01:30:42,660 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 01:30:45,660 - __main__ - INFO - Got aligned ccc_gpu series for adrenal_gland with 1358012670 values
2025-07-03 01:30:45,661 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 01:30:45,661 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_adrenal_gland-var_pc_log2-pearson.pkl
2025-07-03 01:32:42,764 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 01:32:50,481 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 01:32:50,482 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 01:32:50,483 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 01:36:14,341 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 01:36:14,343 - __main__ - INFO - Processed pearson correlation matrix to series with 1358012670 values (dtype: float16)
2025-07-03 01:36:14,357 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 01:36:14,357 - __main__ - INFO -   Original shape: (1358012670,)
2025-07-03 01:36:14,357 - __main__ - INFO -   Data type: float16
2025-07-03 01:36:22,696 - __main__ - INFO -   Memory usage: 12963.01 MB
2025-07-03 01:42:52,362 - __main__ - INFO - Alignment summary:
2025-07-03 01:42:52,362 - __main__ - INFO -   Aligned shape: (1358012670,)
2025-07-03 01:42:52,362 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 01:43:00,817 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 01:43:00,817 - __main__ - INFO - Caching aligned pearson matrix for adrenal_gland:
2025-07-03 01:43:00,817 - __main__ - INFO -   Shape: (1358012670,)
2025-07-03 01:43:00,817 - __main__ - INFO -   Data type: float16
2025-07-03 01:43:00,824 - __main__ - INFO -   Memory usage: 12963.01 MB
2025-07-03 01:43:08,999 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 01:43:34,872 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 01:43:34,872 - __main__ - INFO -   First 5 values:
2025-07-03 01:43:34,874 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000100604.12'): 0.095154
2025-07-03 01:43:34,874 - __main__ - INFO -     ('ENSG00000134184.12', 'ENSG00000100604.12'): 0.061676
2025-07-03 01:43:34,874 - __main__ - INFO -     ('ENSG00000134184.12', 'ENSG00000129824.15'): 0.011032
2025-07-03 01:43:34,874 - __main__ - INFO -     ('ENSG00000180176.14', 'ENSG00000100604.12'): 0.902832
2025-07-03 01:43:34,874 - __main__ - INFO -     ('ENSG00000180176.14', 'ENSG00000129824.15'): 0.098694
2025-07-03 01:43:34,874 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 01:43:34,874 - __main__ - INFO -   Index names: [None, None]
2025-07-03 01:43:46,501 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_adrenal_gland_var_pc_log2.pkl
2025-07-03 01:43:46,501 - __main__ - INFO -   Cache file size: 23313.19 MB
2025-07-03 01:43:46,751 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 01:43:49,853 - __main__ - INFO - Got aligned pearson series for adrenal_gland with 1358012670 values
2025-07-03 01:43:49,853 - __main__ - INFO - Combining 1358012670 gene pairs for adrenal_gland
2025-07-03 01:50:03,081 - __main__ - INFO - Successfully combined correlations for adrenal_gland into DataFrame with shape: (1358012670, 3)
2025-07-03 01:50:03,081 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 18143.4MB
2025-07-03 01:50:03,539 - __main__ - INFO - Saving combined correlations for adrenal_gland to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_adrenal_gland-var_pc_log2-all.pkl
2025-07-03 01:50:03,539 - __main__ - INFO - Saving DataFrame with shape: (1358012670, 3), memory: 18143.4MB
2025-07-03 01:50:03,539 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 01:50:12,776 - __main__ - INFO - Results saved successfully. File size: 18132.8MB
2025-07-03 01:50:12,776 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 01:50:12,776 - __main__ - INFO - Successfully processed tissue: adrenal_gland
2025-07-03 01:50:12,776 - __main__ - INFO - Processing tissue: artery_aorta
2025-07-03 01:50:12,814 - __main__ - INFO - All input files validated successfully for artery_aorta
2025-07-03 01:50:12,814 - __main__ - INFO - Starting correlation combination process for artery_aorta
2025-07-03 01:50:12,814 - __main__ - INFO - Loading gene expression data for artery_aorta from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_artery_aorta-var_pc_log2.pkl
2025-07-03 01:50:13,157 - __main__ - INFO - Loaded gene expression data for artery_aorta with shape: (56200, 432)
2025-07-03 01:50:13,157 - __main__ - INFO - Need to load and process for artery_aorta: ccc_gpu, pearson, spearman
2025-07-03 01:50:13,157 - __main__ - INFO - No cache found for spearman in artery_aorta, loading and processing matrix
2025-07-03 01:50:13,157 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_aorta-var_pc_log2-spearman.pkl
2025-07-03 01:50:40,877 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 01:50:48,528 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 01:50:48,530 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 01:50:48,530 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 01:52:25,587 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 01:52:25,588 - __main__ - INFO - Processed spearman correlation matrix to series with 1419832116 values (dtype: float16)
2025-07-03 01:52:25,600 - __main__ - INFO - Processed spearman matrix for artery_aorta (reference):
2025-07-03 01:52:25,601 - __main__ - INFO -   Shape: (1419832116,)
2025-07-03 01:52:25,601 - __main__ - INFO -   Data type: float16
2025-07-03 01:52:34,372 - __main__ - INFO -   Memory usage: 13552.56 MB
2025-07-03 01:52:34,372 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 01:52:34,372 - __main__ - INFO - Caching aligned spearman matrix for artery_aorta:
2025-07-03 01:52:34,372 - __main__ - INFO -   Shape: (1419832116,)
2025-07-03 01:52:34,372 - __main__ - INFO -   Data type: float16
2025-07-03 01:52:34,378 - __main__ - INFO -   Memory usage: 13552.56 MB
2025-07-03 01:52:42,855 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 01:53:10,637 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 01:53:10,637 - __main__ - INFO -   First 5 values:
2025-07-03 01:53:10,637 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.671387
2025-07-03 01:53:10,637 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.812988
2025-07-03 01:53:10,637 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000229807.10'): 0.679199
2025-07-03 01:53:10,637 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000129824.15'): 0.716797
2025-07-03 01:53:10,637 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000229807.10'): 0.708008
2025-07-03 01:53:10,637 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 01:53:10,637 - __main__ - INFO -   Index names: [None, None]
2025-07-03 01:54:32,196 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_artery_aorta_var_pc_log2.pkl
2025-07-03 01:54:32,196 - __main__ - INFO -   Cache file size: 24374.39 MB
2025-07-03 01:54:32,453 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 01:54:32,453 - __main__ - INFO - Using Spearman indices as reference for artery_aorta: 1419832116 gene pairs
2025-07-03 01:54:32,453 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 01:54:32,453 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_aorta-var_pc_log2-ccc_gpu.pkl
2025-07-03 01:56:07,263 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 01:56:29,808 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 01:56:29,810 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 01:56:29,810 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 01:59:31,227 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578507659 values (dtype: float16)
2025-07-03 01:59:31,243 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 01:59:31,243 - __main__ - INFO -   Original shape: (1578507659,)
2025-07-03 01:59:31,243 - __main__ - INFO -   Data type: float16
2025-07-03 01:59:40,986 - __main__ - INFO -   Memory usage: 15065.81 MB
2025-07-03 02:06:29,225 - __main__ - INFO - Alignment summary:
2025-07-03 02:06:29,225 - __main__ - INFO -   Aligned shape: (1419832116,)
2025-07-03 02:06:29,225 - __main__ - INFO -   Alignment ratio: 89.95% of original
2025-07-03 02:06:38,021 - __main__ - INFO -   Memory saved: 34537.25 MB
2025-07-03 02:06:38,021 - __main__ - INFO - Caching aligned ccc_gpu matrix for artery_aorta:
2025-07-03 02:06:38,021 - __main__ - INFO -   Shape: (1419832116,)
2025-07-03 02:06:38,021 - __main__ - INFO -   Data type: float16
2025-07-03 02:06:38,028 - __main__ - INFO -   Memory usage: 13552.56 MB
2025-07-03 02:06:46,664 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 02:07:53,605 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 02:07:53,605 - __main__ - INFO -   First 5 values:
2025-07-03 02:07:53,605 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.411377
2025-07-03 02:07:53,605 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.515137
2025-07-03 02:07:53,605 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000229807.10'): 0.414551
2025-07-03 02:07:53,606 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000129824.15'): 0.453369
2025-07-03 02:07:53,606 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000229807.10'): 0.416748
2025-07-03 02:07:53,606 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 02:07:53,606 - __main__ - INFO -   Index names: [None, None]
2025-07-03 02:08:21,822 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_artery_aorta_var_pc_log2.pkl
2025-07-03 02:08:21,822 - __main__ - INFO -   Cache file size: 24374.39 MB
2025-07-03 02:08:22,076 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 02:08:25,143 - __main__ - INFO - Got aligned ccc_gpu series for artery_aorta with 1419832116 values
2025-07-03 02:08:25,143 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 02:08:25,143 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_aorta-var_pc_log2-pearson.pkl
2025-07-03 02:10:45,704 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 02:10:53,410 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 02:10:53,412 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 02:10:53,412 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 02:14:36,136 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 02:14:36,138 - __main__ - INFO - Processed pearson correlation matrix to series with 1419832116 values (dtype: float16)
2025-07-03 02:14:36,153 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 02:14:36,153 - __main__ - INFO -   Original shape: (1419832116,)
2025-07-03 02:14:36,153 - __main__ - INFO -   Data type: float16
2025-07-03 02:14:44,921 - __main__ - INFO -   Memory usage: 13552.56 MB
2025-07-03 02:21:23,829 - __main__ - INFO - Alignment summary:
2025-07-03 02:21:23,829 - __main__ - INFO -   Aligned shape: (1419832116,)
2025-07-03 02:21:23,829 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 02:21:32,605 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 02:21:32,605 - __main__ - INFO - Caching aligned pearson matrix for artery_aorta:
2025-07-03 02:21:32,605 - __main__ - INFO -   Shape: (1419832116,)
2025-07-03 02:21:32,605 - __main__ - INFO -   Data type: float16
2025-07-03 02:21:32,611 - __main__ - INFO -   Memory usage: 13552.56 MB
2025-07-03 02:21:41,175 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 02:22:09,869 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 02:22:09,869 - __main__ - INFO -   First 5 values:
2025-07-03 02:22:09,870 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.828613
2025-07-03 02:22:09,870 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.917480
2025-07-03 02:22:09,870 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000229807.10'): 0.805176
2025-07-03 02:22:09,870 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000129824.15'): 0.880859
2025-07-03 02:22:09,870 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000229807.10'): 0.802246
2025-07-03 02:22:09,870 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 02:22:09,870 - __main__ - INFO -   Index names: [None, None]
2025-07-03 02:22:37,880 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_artery_aorta_var_pc_log2.pkl
2025-07-03 02:22:37,880 - __main__ - INFO -   Cache file size: 24374.39 MB
2025-07-03 02:22:38,134 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 02:22:41,165 - __main__ - INFO - Got aligned pearson series for artery_aorta with 1419832116 values
2025-07-03 02:22:41,165 - __main__ - INFO - Combining 1419832116 gene pairs for artery_aorta
2025-07-03 02:29:11,820 - __main__ - INFO - Successfully combined correlations for artery_aorta into DataFrame with shape: (1419832116, 3)
2025-07-03 02:29:11,820 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 18968.8MB
2025-07-03 02:29:12,289 - __main__ - INFO - Saving combined correlations for artery_aorta to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_aorta-var_pc_log2-all.pkl
2025-07-03 02:29:12,289 - __main__ - INFO - Saving DataFrame with shape: (1419832116, 3), memory: 18968.8MB
2025-07-03 02:29:12,289 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 02:29:21,992 - __main__ - INFO - Results saved successfully. File size: 18958.2MB
2025-07-03 02:29:21,992 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 02:29:21,992 - __main__ - INFO - Successfully processed tissue: artery_aorta
2025-07-03 02:29:21,992 - __main__ - INFO - Processing tissue: artery_coronary
2025-07-03 02:29:22,015 - __main__ - INFO - All input files validated successfully for artery_coronary
2025-07-03 02:29:22,015 - __main__ - INFO - Starting correlation combination process for artery_coronary
2025-07-03 02:29:22,015 - __main__ - INFO - Loading gene expression data for artery_coronary from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_artery_coronary-var_pc_log2.pkl
2025-07-03 02:29:22,196 - __main__ - INFO - Loaded gene expression data for artery_coronary with shape: (56200, 240)
2025-07-03 02:29:22,197 - __main__ - INFO - Need to load and process for artery_coronary: ccc_gpu, pearson, spearman
2025-07-03 02:29:22,197 - __main__ - INFO - No cache found for spearman in artery_coronary, loading and processing matrix
2025-07-03 02:29:22,197 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_coronary-var_pc_log2-spearman.pkl
2025-07-03 02:31:09,651 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 02:31:17,188 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 02:31:17,189 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 02:31:17,190 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 02:32:59,698 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 02:32:59,698 - __main__ - INFO - Processed spearman correlation matrix to series with 1373430255 values (dtype: float16)
2025-07-03 02:32:59,713 - __main__ - INFO - Processed spearman matrix for artery_coronary (reference):
2025-07-03 02:32:59,713 - __main__ - INFO -   Shape: (1373430255,)
2025-07-03 02:32:59,713 - __main__ - INFO -   Data type: float16
2025-07-03 02:33:08,237 - __main__ - INFO -   Memory usage: 13110.04 MB
2025-07-03 02:33:08,237 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 02:33:08,237 - __main__ - INFO - Caching aligned spearman matrix for artery_coronary:
2025-07-03 02:33:08,237 - __main__ - INFO -   Shape: (1373430255,)
2025-07-03 02:33:08,237 - __main__ - INFO -   Data type: float16
2025-07-03 02:33:08,244 - __main__ - INFO -   Memory usage: 13110.04 MB
2025-07-03 02:33:16,549 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 02:33:41,158 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 02:33:41,158 - __main__ - INFO -   First 5 values:
2025-07-03 02:33:41,158 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.702148
2025-07-03 02:33:41,158 - __main__ - INFO -     ('ENSG00000181092.9', 'ENSG00000129824.15'): 0.238037
2025-07-03 02:33:41,158 - __main__ - INFO -     ('ENSG00000181092.9', 'ENSG00000229807.10'): 0.103638
2025-07-03 02:33:41,158 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000129824.15'): 0.107727
2025-07-03 02:33:41,158 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000229807.10'): 0.174072
2025-07-03 02:33:41,158 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 02:33:41,158 - __main__ - INFO -   Index names: [None, None]
2025-07-03 02:33:52,738 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_artery_coronary_var_pc_log2.pkl
2025-07-03 02:33:52,738 - __main__ - INFO -   Cache file size: 23577.85 MB
2025-07-03 02:33:52,989 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 02:33:52,989 - __main__ - INFO - Using Spearman indices as reference for artery_coronary: 1373430255 gene pairs
2025-07-03 02:33:52,989 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 02:33:52,989 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_coronary-var_pc_log2-ccc_gpu.pkl
2025-07-03 02:35:08,727 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 02:35:24,846 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 02:35:24,847 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 02:35:24,848 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 02:38:21,456 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578283450 values (dtype: float16)
2025-07-03 02:38:21,473 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 02:38:21,473 - __main__ - INFO -   Original shape: (1578283450,)
2025-07-03 02:38:21,473 - __main__ - INFO -   Data type: float16
2025-07-03 02:38:31,162 - __main__ - INFO -   Memory usage: 15063.67 MB
2025-07-03 02:45:03,853 - __main__ - INFO - Alignment summary:
2025-07-03 02:45:03,853 - __main__ - INFO -   Aligned shape: (1373430255,)
2025-07-03 02:45:03,853 - __main__ - INFO -   Alignment ratio: 87.02% of original
2025-07-03 02:45:12,382 - __main__ - INFO -   Memory saved: 34977.63 MB
2025-07-03 02:45:12,382 - __main__ - INFO - Caching aligned ccc_gpu matrix for artery_coronary:
2025-07-03 02:45:12,382 - __main__ - INFO -   Shape: (1373430255,)
2025-07-03 02:45:12,382 - __main__ - INFO -   Data type: float16
2025-07-03 02:45:12,389 - __main__ - INFO -   Memory usage: 13110.04 MB
2025-07-03 02:45:20,744 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 02:46:16,706 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 02:46:16,706 - __main__ - INFO -   First 5 values:
2025-07-03 02:46:16,707 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.464600
2025-07-03 02:46:16,707 - __main__ - INFO -     ('ENSG00000181092.9', 'ENSG00000129824.15'): 0.050995
2025-07-03 02:46:16,707 - __main__ - INFO -     ('ENSG00000181092.9', 'ENSG00000229807.10'): 0.012993
2025-07-03 02:46:16,707 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000129824.15'): 0.015617
2025-07-03 02:46:16,707 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000229807.10'): 0.028595
2025-07-03 02:46:16,707 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 02:46:16,707 - __main__ - INFO -   Index names: [None, None]
2025-07-03 02:46:43,192 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_artery_coronary_var_pc_log2.pkl
2025-07-03 02:46:43,192 - __main__ - INFO -   Cache file size: 23577.85 MB
2025-07-03 02:46:43,444 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 02:46:46,463 - __main__ - INFO - Got aligned ccc_gpu series for artery_coronary with 1373430255 values
2025-07-03 02:46:46,463 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 02:46:46,463 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_coronary-var_pc_log2-pearson.pkl
2025-07-03 02:49:03,631 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 02:49:11,307 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 02:49:11,309 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 02:49:11,309 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 02:52:43,586 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 02:52:43,587 - __main__ - INFO - Processed pearson correlation matrix to series with 1373430255 values (dtype: float16)
2025-07-03 02:52:43,602 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 02:52:43,602 - __main__ - INFO -   Original shape: (1373430255,)
2025-07-03 02:52:43,602 - __main__ - INFO -   Data type: float16
2025-07-03 02:52:52,144 - __main__ - INFO -   Memory usage: 13110.04 MB
2025-07-03 02:59:20,074 - __main__ - INFO - Alignment summary:
2025-07-03 02:59:20,074 - __main__ - INFO -   Aligned shape: (1373430255,)
2025-07-03 02:59:20,074 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 02:59:28,606 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 02:59:28,606 - __main__ - INFO - Caching aligned pearson matrix for artery_coronary:
2025-07-03 02:59:28,606 - __main__ - INFO -   Shape: (1373430255,)
2025-07-03 02:59:28,606 - __main__ - INFO -   Data type: float16
2025-07-03 02:59:28,613 - __main__ - INFO -   Memory usage: 13110.04 MB
2025-07-03 02:59:36,904 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 03:00:02,347 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 03:00:02,347 - __main__ - INFO -   First 5 values:
2025-07-03 03:00:02,349 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.808594
2025-07-03 03:00:02,349 - __main__ - INFO -     ('ENSG00000181092.9', 'ENSG00000129824.15'): 0.098206
2025-07-03 03:00:02,349 - __main__ - INFO -     ('ENSG00000181092.9', 'ENSG00000229807.10'): 0.031342
2025-07-03 03:00:02,349 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000129824.15'): 0.044739
2025-07-03 03:00:02,349 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000229807.10'): 0.076965
2025-07-03 03:00:02,349 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 03:00:02,349 - __main__ - INFO -   Index names: [None, None]
2025-07-03 03:00:29,100 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_artery_coronary_var_pc_log2.pkl
2025-07-03 03:00:29,100 - __main__ - INFO -   Cache file size: 23577.85 MB
2025-07-03 03:00:29,359 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 03:00:32,434 - __main__ - INFO - Got aligned pearson series for artery_coronary with 1373430255 values
2025-07-03 03:00:32,434 - __main__ - INFO - Combining 1373430255 gene pairs for artery_coronary
2025-07-03 03:06:51,550 - __main__ - INFO - Successfully combined correlations for artery_coronary into DataFrame with shape: (1373430255, 3)
2025-07-03 03:06:51,551 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 18349.3MB
2025-07-03 03:06:52,019 - __main__ - INFO - Saving combined correlations for artery_coronary to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_coronary-var_pc_log2-all.pkl
2025-07-03 03:06:52,019 - __main__ - INFO - Saving DataFrame with shape: (1373430255, 3), memory: 18349.3MB
2025-07-03 03:06:52,019 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 03:07:01,402 - __main__ - INFO - Results saved successfully. File size: 18338.6MB
2025-07-03 03:07:01,402 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 03:07:01,402 - __main__ - INFO - Successfully processed tissue: artery_coronary
2025-07-03 03:07:01,402 - __main__ - INFO - Processing tissue: artery_tibial
2025-07-03 03:07:01,406 - __main__ - INFO - All input files validated successfully for artery_tibial
2025-07-03 03:07:01,406 - __main__ - INFO - Starting correlation combination process for artery_tibial
2025-07-03 03:07:01,406 - __main__ - INFO - Loading gene expression data for artery_tibial from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_artery_tibial-var_pc_log2.pkl
2025-07-03 03:07:01,926 - __main__ - INFO - Loaded gene expression data for artery_tibial with shape: (56200, 663)
2025-07-03 03:07:01,926 - __main__ - INFO - Need to load and process for artery_tibial: ccc_gpu, pearson, spearman
2025-07-03 03:07:01,926 - __main__ - INFO - No cache found for spearman in artery_tibial, loading and processing matrix
2025-07-03 03:07:01,926 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_tibial-var_pc_log2-spearman.pkl
2025-07-03 03:07:25,689 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 03:07:33,303 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 03:07:33,304 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 03:07:33,305 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 03:09:17,275 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 03:09:17,275 - __main__ - INFO - Processed spearman correlation matrix to series with 1454033701 values (dtype: float16)
2025-07-03 03:09:17,288 - __main__ - INFO - Processed spearman matrix for artery_tibial (reference):
2025-07-03 03:09:17,288 - __main__ - INFO -   Shape: (1454033701,)
2025-07-03 03:09:17,288 - __main__ - INFO -   Data type: float16
2025-07-03 03:09:26,318 - __main__ - INFO -   Memory usage: 13878.73 MB
2025-07-03 03:09:26,318 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 03:09:26,318 - __main__ - INFO - Caching aligned spearman matrix for artery_tibial:
2025-07-03 03:09:26,318 - __main__ - INFO -   Shape: (1454033701,)
2025-07-03 03:09:26,318 - __main__ - INFO -   Data type: float16
2025-07-03 03:09:26,324 - __main__ - INFO -   Memory usage: 13878.73 MB
2025-07-03 03:09:35,181 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 03:10:06,092 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 03:10:06,093 - __main__ - INFO -   First 5 values:
2025-07-03 03:10:06,093 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.693359
2025-07-03 03:10:06,093 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.629883
2025-07-03 03:10:06,093 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000229807.10'): 0.619629
2025-07-03 03:10:06,093 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.008904
2025-07-03 03:10:06,093 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000229807.10'): 0.046875
2025-07-03 03:10:06,093 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 03:10:06,093 - __main__ - INFO -   Index names: [None, None]
2025-07-03 03:10:18,711 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_artery_tibial_var_pc_log2.pkl
2025-07-03 03:10:18,712 - __main__ - INFO -   Cache file size: 24961.50 MB
2025-07-03 03:10:18,958 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 03:10:18,958 - __main__ - INFO - Using Spearman indices as reference for artery_tibial: 1454033701 gene pairs
2025-07-03 03:10:18,958 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 03:10:18,958 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_tibial-var_pc_log2-ccc_gpu.pkl
2025-07-03 03:10:46,748 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 03:11:12,607 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 03:11:12,608 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 03:11:12,608 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 03:14:29,226 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578664134 values (dtype: float16)
2025-07-03 03:14:29,241 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 03:14:29,241 - __main__ - INFO -   Original shape: (1578664134,)
2025-07-03 03:14:29,241 - __main__ - INFO -   Data type: float16
2025-07-03 03:14:38,959 - __main__ - INFO -   Memory usage: 15067.30 MB
2025-07-03 03:21:34,744 - __main__ - INFO - Alignment summary:
2025-07-03 03:21:34,744 - __main__ - INFO -   Aligned shape: (1454033701,)
2025-07-03 03:21:34,744 - __main__ - INFO -   Alignment ratio: 92.11% of original
2025-07-03 03:21:43,739 - __main__ - INFO -   Memory saved: 34212.57 MB
2025-07-03 03:21:43,740 - __main__ - INFO - Caching aligned ccc_gpu matrix for artery_tibial:
2025-07-03 03:21:43,740 - __main__ - INFO -   Shape: (1454033701,)
2025-07-03 03:21:43,740 - __main__ - INFO -   Data type: float16
2025-07-03 03:21:43,746 - __main__ - INFO -   Memory usage: 13878.73 MB
2025-07-03 03:21:52,584 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 03:23:05,485 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 03:23:05,485 - __main__ - INFO -   First 5 values:
2025-07-03 03:23:05,485 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.432861
2025-07-03 03:23:05,485 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.436523
2025-07-03 03:23:05,485 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000229807.10'): 0.422363
2025-07-03 03:23:05,485 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.009125
2025-07-03 03:23:05,485 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000229807.10'): 0.006886
2025-07-03 03:23:05,485 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 03:23:05,485 - __main__ - INFO -   Index names: [None, None]
2025-07-03 03:23:33,477 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_artery_tibial_var_pc_log2.pkl
2025-07-03 03:23:33,477 - __main__ - INFO -   Cache file size: 24961.50 MB
2025-07-03 03:23:33,728 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 03:23:36,720 - __main__ - INFO - Got aligned ccc_gpu series for artery_tibial with 1454033701 values
2025-07-03 03:23:36,720 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 03:23:36,720 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_tibial-var_pc_log2-pearson.pkl
2025-07-03 03:24:36,950 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 03:24:44,749 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 03:24:44,751 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 03:24:44,751 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 03:28:20,225 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 03:28:20,227 - __main__ - INFO - Processed pearson correlation matrix to series with 1454033701 values (dtype: float16)
2025-07-03 03:28:20,241 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 03:28:20,241 - __main__ - INFO -   Original shape: (1454033701,)
2025-07-03 03:28:20,241 - __main__ - INFO -   Data type: float16
2025-07-03 03:28:29,109 - __main__ - INFO -   Memory usage: 13878.73 MB
2025-07-03 03:35:14,726 - __main__ - INFO - Alignment summary:
2025-07-03 03:35:14,727 - __main__ - INFO -   Aligned shape: (1454033701,)
2025-07-03 03:35:14,727 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 03:35:23,708 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 03:35:23,708 - __main__ - INFO - Caching aligned pearson matrix for artery_tibial:
2025-07-03 03:35:23,708 - __main__ - INFO -   Shape: (1454033701,)
2025-07-03 03:35:23,708 - __main__ - INFO -   Data type: float16
2025-07-03 03:35:23,715 - __main__ - INFO -   Memory usage: 13878.73 MB
2025-07-03 03:35:32,479 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 03:36:05,146 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 03:36:05,146 - __main__ - INFO -   First 5 values:
2025-07-03 03:36:05,148 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.809570
2025-07-03 03:36:05,148 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.849609
2025-07-03 03:36:05,148 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000229807.10'): 0.809570
2025-07-03 03:36:05,148 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.015823
2025-07-03 03:36:05,148 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000229807.10'): 0.018280
2025-07-03 03:36:05,148 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 03:36:05,148 - __main__ - INFO -   Index names: [None, None]
2025-07-03 03:36:17,255 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_artery_tibial_var_pc_log2.pkl
2025-07-03 03:36:17,255 - __main__ - INFO -   Cache file size: 24961.50 MB
2025-07-03 03:36:17,501 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 03:36:20,505 - __main__ - INFO - Got aligned pearson series for artery_tibial with 1454033701 values
2025-07-03 03:36:20,505 - __main__ - INFO - Combining 1454033701 gene pairs for artery_tibial
2025-07-03 03:43:02,028 - __main__ - INFO - Successfully combined correlations for artery_tibial into DataFrame with shape: (1454033701, 3)
2025-07-03 03:43:02,028 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 19425.4MB
2025-07-03 03:43:02,513 - __main__ - INFO - Saving combined correlations for artery_tibial to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_artery_tibial-var_pc_log2-all.pkl
2025-07-03 03:43:02,513 - __main__ - INFO - Saving DataFrame with shape: (1454033701, 3), memory: 19425.4MB
2025-07-03 03:43:02,513 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 03:43:12,966 - __main__ - INFO - Results saved successfully. File size: 19414.8MB
2025-07-03 03:43:12,966 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 03:43:12,966 - __main__ - INFO - Successfully processed tissue: artery_tibial
2025-07-03 03:43:12,966 - __main__ - INFO - Processing tissue: bladder
2025-07-03 03:43:12,968 - __main__ - INFO - All input files validated successfully for bladder
2025-07-03 03:43:12,968 - __main__ - INFO - Starting correlation combination process for bladder
2025-07-03 03:43:12,968 - __main__ - INFO - Loading gene expression data for bladder from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_bladder-var_pc_log2.pkl
2025-07-03 03:43:12,993 - __main__ - INFO - Loaded gene expression data for bladder with shape: (56200, 21)
2025-07-03 03:43:12,993 - __main__ - INFO - Need to load and process for bladder: ccc_gpu, pearson, spearman
2025-07-03 03:43:12,993 - __main__ - INFO - No cache found for spearman in bladder, loading and processing matrix
2025-07-03 03:43:12,993 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_bladder-var_pc_log2-spearman.pkl
2025-07-03 03:43:42,085 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 03:43:49,545 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 03:43:49,547 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 03:43:49,547 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 03:45:31,294 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 03:45:31,294 - __main__ - INFO - Processed spearman correlation matrix to series with 995271420 values (dtype: float16)
2025-07-03 03:45:31,307 - __main__ - INFO - Processed spearman matrix for bladder (reference):
2025-07-03 03:45:31,307 - __main__ - INFO -   Shape: (995271420,)
2025-07-03 03:45:31,307 - __main__ - INFO -   Data type: float16
2025-07-03 03:45:37,438 - __main__ - INFO -   Memory usage: 9503.64 MB
2025-07-03 03:45:37,438 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 03:45:37,439 - __main__ - INFO - Caching aligned spearman matrix for bladder:
2025-07-03 03:45:37,439 - __main__ - INFO -   Shape: (995271420,)
2025-07-03 03:45:37,439 - __main__ - INFO -   Data type: float16
2025-07-03 03:45:37,445 - __main__ - INFO -   Memory usage: 9503.64 MB
2025-07-03 03:45:43,465 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 03:45:58,661 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 03:45:58,661 - __main__ - INFO -   First 5 values:
2025-07-03 03:45:58,662 - __main__ - INFO -     ('ENSG00000211593.2', 'ENSG00000167653.4'): 0.408203
2025-07-03 03:45:58,662 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000167653.4'): 0.018188
2025-07-03 03:45:58,662 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000211593.2'): 0.277100
2025-07-03 03:45:58,662 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000167653.4'): 0.341553
2025-07-03 03:45:58,662 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000211593.2'): 0.797852
2025-07-03 03:45:58,662 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 03:45:58,662 - __main__ - INFO -   Index names: [None, None]
2025-07-03 03:49:19,551 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_bladder_var_pc_log2.pkl
2025-07-03 03:49:19,551 - __main__ - INFO -   Cache file size: 17086.32 MB
2025-07-03 03:49:19,801 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 03:49:19,802 - __main__ - INFO - Using Spearman indices as reference for bladder: 995271420 gene pairs
2025-07-03 03:49:19,802 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 03:49:19,802 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_bladder-var_pc_log2-ccc_gpu.pkl
2025-07-03 03:49:45,299 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 03:49:54,531 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 03:49:54,533 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 03:49:54,533 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 03:52:36,433 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1575680376 values (dtype: float16)
2025-07-03 03:52:36,448 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 03:52:36,448 - __main__ - INFO -   Original shape: (1575680376,)
2025-07-03 03:52:36,448 - __main__ - INFO -   Data type: float16
2025-07-03 03:52:46,096 - __main__ - INFO -   Memory usage: 15038.85 MB
2025-07-03 03:57:57,737 - __main__ - INFO - Alignment summary:
2025-07-03 03:57:57,737 - __main__ - INFO -   Aligned shape: (995271420,)
2025-07-03 03:57:57,737 - __main__ - INFO -   Alignment ratio: 63.16% of original
2025-07-03 03:58:03,864 - __main__ - INFO -   Memory saved: 38559.21 MB
2025-07-03 03:58:03,865 - __main__ - INFO - Caching aligned ccc_gpu matrix for bladder:
2025-07-03 03:58:03,865 - __main__ - INFO -   Shape: (995271420,)
2025-07-03 03:58:03,865 - __main__ - INFO -   Data type: float16
2025-07-03 03:58:03,871 - __main__ - INFO -   Memory usage: 9503.64 MB
2025-07-03 03:58:09,931 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 03:58:30,360 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 03:58:30,360 - __main__ - INFO -   First 5 values:
2025-07-03 03:58:30,360 - __main__ - INFO -     ('ENSG00000211593.2', 'ENSG00000167653.4'): 0.152100
2025-07-03 03:58:30,360 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000167653.4'): 0.087585
2025-07-03 03:58:30,360 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000211593.2'): 0.107483
2025-07-03 03:58:30,361 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000167653.4'): 0.114319
2025-07-03 03:58:30,361 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000211593.2'): 0.455811
2025-07-03 03:58:30,361 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 03:58:30,361 - __main__ - INFO -   Index names: [None, None]
2025-07-03 04:01:23,532 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_bladder_var_pc_log2.pkl
2025-07-03 04:01:23,532 - __main__ - INFO -   Cache file size: 17086.32 MB
2025-07-03 04:01:23,776 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 04:01:26,724 - __main__ - INFO - Got aligned ccc_gpu series for bladder with 995271420 values
2025-07-03 04:01:26,724 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 04:01:26,724 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_bladder-var_pc_log2-pearson.pkl
2025-07-03 04:01:51,017 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 04:01:58,460 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 04:01:58,462 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 04:01:58,462 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 04:04:58,802 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 04:04:58,803 - __main__ - INFO - Processed pearson correlation matrix to series with 995271420 values (dtype: float16)
2025-07-03 04:04:58,818 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 04:04:58,818 - __main__ - INFO -   Original shape: (995271420,)
2025-07-03 04:04:58,818 - __main__ - INFO -   Data type: float16
2025-07-03 04:05:04,978 - __main__ - INFO -   Memory usage: 9503.64 MB
2025-07-03 04:10:12,325 - __main__ - INFO - Alignment summary:
2025-07-03 04:10:12,325 - __main__ - INFO -   Aligned shape: (995271420,)
2025-07-03 04:10:12,325 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 04:10:18,460 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 04:10:18,461 - __main__ - INFO - Caching aligned pearson matrix for bladder:
2025-07-03 04:10:18,461 - __main__ - INFO -   Shape: (995271420,)
2025-07-03 04:10:18,461 - __main__ - INFO -   Data type: float16
2025-07-03 04:10:18,467 - __main__ - INFO -   Memory usage: 9503.64 MB
2025-07-03 04:10:24,458 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 04:10:39,868 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 04:10:39,868 - __main__ - INFO -   First 5 values:
2025-07-03 04:10:39,868 - __main__ - INFO -     ('ENSG00000211593.2', 'ENSG00000167653.4'): 0.403076
2025-07-03 04:10:39,869 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000167653.4'): 0.036774
2025-07-03 04:10:39,869 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000211593.2'): 0.300537
2025-07-03 04:10:39,869 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000167653.4'): 0.468750
2025-07-03 04:10:39,869 - __main__ - INFO -     ('ENSG00000211595.2', 'ENSG00000211593.2'): 0.851074
2025-07-03 04:10:39,869 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 04:10:39,869 - __main__ - INFO -   Index names: [None, None]
2025-07-03 04:15:29,024 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_bladder_var_pc_log2.pkl
2025-07-03 04:15:29,024 - __main__ - INFO -   Cache file size: 17086.32 MB
2025-07-03 04:15:29,297 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 04:15:32,348 - __main__ - INFO - Got aligned pearson series for bladder with 995271420 values
2025-07-03 04:15:32,348 - __main__ - INFO - Combining 995271420 gene pairs for bladder
2025-07-03 04:20:06,965 - __main__ - INFO - Successfully combined correlations for bladder into DataFrame with shape: (995271420, 3)
2025-07-03 04:20:06,965 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 13300.3MB
2025-07-03 04:20:07,324 - __main__ - INFO - Saving combined correlations for bladder to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_bladder-var_pc_log2-all.pkl
2025-07-03 04:20:07,324 - __main__ - INFO - Saving DataFrame with shape: (995271420, 3), memory: 13300.3MB
2025-07-03 04:20:07,324 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 04:22:16,152 - __main__ - INFO - Results saved successfully. File size: 13289.7MB
2025-07-03 04:22:16,152 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 04:22:16,152 - __main__ - INFO - Successfully processed tissue: bladder
2025-07-03 04:22:16,152 - __main__ - INFO - Processing tissue: brain_amygdala
2025-07-03 04:22:16,355 - __main__ - INFO - All input files validated successfully for brain_amygdala
2025-07-03 04:22:16,356 - __main__ - INFO - Starting correlation combination process for brain_amygdala
2025-07-03 04:22:16,356 - __main__ - INFO - Loading gene expression data for brain_amygdala from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_amygdala-var_pc_log2.pkl
2025-07-03 04:22:16,960 - __main__ - INFO - Loaded gene expression data for brain_amygdala with shape: (56200, 152)
2025-07-03 04:22:16,961 - __main__ - INFO - Need to load and process for brain_amygdala: ccc_gpu, pearson, spearman
2025-07-03 04:22:16,961 - __main__ - INFO - No cache found for spearman in brain_amygdala, loading and processing matrix
2025-07-03 04:22:16,961 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_amygdala-var_pc_log2-spearman.pkl
2025-07-03 04:22:46,718 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 04:22:54,294 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 04:22:54,295 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 04:22:54,296 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 04:24:28,310 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 04:24:28,310 - __main__ - INFO - Processed spearman correlation matrix to series with 1313153128 values (dtype: float16)
2025-07-03 04:24:28,323 - __main__ - INFO - Processed spearman matrix for brain_amygdala (reference):
2025-07-03 04:24:28,323 - __main__ - INFO -   Shape: (1313153128,)
2025-07-03 04:24:28,323 - __main__ - INFO -   Data type: float16
2025-07-03 04:24:36,460 - __main__ - INFO -   Memory usage: 12535.19 MB
2025-07-03 04:24:36,460 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 04:24:36,460 - __main__ - INFO - Caching aligned spearman matrix for brain_amygdala:
2025-07-03 04:24:36,460 - __main__ - INFO -   Shape: (1313153128,)
2025-07-03 04:24:36,460 - __main__ - INFO -   Data type: float16
2025-07-03 04:24:36,467 - __main__ - INFO -   Memory usage: 12535.19 MB
2025-07-03 04:24:44,419 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 04:25:06,108 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 04:25:06,108 - __main__ - INFO -   First 5 values:
2025-07-03 04:25:06,108 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.156006
2025-07-03 04:25:06,109 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000134184.12'): 0.032776
2025-07-03 04:25:06,109 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000129824.15'): 0.046356
2025-07-03 04:25:06,109 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000134184.12'): 0.058746
2025-07-03 04:25:06,109 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000129824.15'): 0.026199
2025-07-03 04:25:06,109 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 04:25:06,109 - __main__ - INFO -   Index names: [None, None]
2025-07-03 04:31:19,673 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_amygdala_var_pc_log2.pkl
2025-07-03 04:31:19,673 - __main__ - INFO -   Cache file size: 22543.12 MB
2025-07-03 04:31:19,946 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 04:31:19,946 - __main__ - INFO - Using Spearman indices as reference for brain_amygdala: 1313153128 gene pairs
2025-07-03 04:31:19,946 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 04:31:19,946 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_amygdala-var_pc_log2-ccc_gpu.pkl
2025-07-03 04:31:46,315 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 04:31:58,371 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 04:31:58,373 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 04:31:58,373 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 04:34:57,339 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1577965257 values (dtype: float16)
2025-07-03 04:34:57,354 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 04:34:57,354 - __main__ - INFO -   Original shape: (1577965257,)
2025-07-03 04:34:57,354 - __main__ - INFO -   Data type: float16
2025-07-03 04:35:07,131 - __main__ - INFO -   Memory usage: 15060.64 MB
2025-07-03 04:41:24,138 - __main__ - INFO - Alignment summary:
2025-07-03 04:41:24,138 - __main__ - INFO -   Aligned shape: (1313153128,)
2025-07-03 04:41:24,138 - __main__ - INFO -   Alignment ratio: 83.22% of original
2025-07-03 04:41:32,246 - __main__ - INFO -   Memory saved: 35549.45 MB
2025-07-03 04:41:32,246 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_amygdala:
2025-07-03 04:41:32,246 - __main__ - INFO -   Shape: (1313153128,)
2025-07-03 04:41:32,246 - __main__ - INFO -   Data type: float16
2025-07-03 04:41:32,253 - __main__ - INFO -   Memory usage: 12535.19 MB
2025-07-03 04:41:40,240 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 04:42:26,492 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 04:42:26,492 - __main__ - INFO -   First 5 values:
2025-07-03 04:42:26,492 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.058685
2025-07-03 04:42:26,492 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000134184.12'): 0.042633
2025-07-03 04:42:26,492 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000129824.15'): 0.015259
2025-07-03 04:42:26,492 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000134184.12'): 0.018188
2025-07-03 04:42:26,492 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000129824.15'): 0.033203
2025-07-03 04:42:26,492 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 04:42:26,492 - __main__ - INFO -   Index names: [None, None]
2025-07-03 04:45:47,848 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_brain_amygdala_var_pc_log2.pkl
2025-07-03 04:45:47,848 - __main__ - INFO -   Cache file size: 22543.12 MB
2025-07-03 04:45:48,098 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 04:45:51,078 - __main__ - INFO - Got aligned ccc_gpu series for brain_amygdala with 1313153128 values
2025-07-03 04:45:51,078 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 04:45:51,078 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_amygdala-var_pc_log2-pearson.pkl
2025-07-03 04:47:17,673 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 04:47:25,265 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 04:47:25,266 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 04:47:25,266 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 04:50:47,545 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 04:50:47,546 - __main__ - INFO - Processed pearson correlation matrix to series with 1313153128 values (dtype: float16)
2025-07-03 04:50:47,561 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 04:50:47,561 - __main__ - INFO -   Original shape: (1313153128,)
2025-07-03 04:50:47,561 - __main__ - INFO -   Data type: float16
2025-07-03 04:50:55,668 - __main__ - INFO -   Memory usage: 12535.19 MB
2025-07-03 04:57:05,595 - __main__ - INFO - Alignment summary:
2025-07-03 04:57:05,595 - __main__ - INFO -   Aligned shape: (1313153128,)
2025-07-03 04:57:05,595 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 04:57:13,689 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 04:57:13,690 - __main__ - INFO - Caching aligned pearson matrix for brain_amygdala:
2025-07-03 04:57:13,690 - __main__ - INFO -   Shape: (1313153128,)
2025-07-03 04:57:13,690 - __main__ - INFO -   Data type: float16
2025-07-03 04:57:13,696 - __main__ - INFO -   Memory usage: 12535.19 MB
2025-07-03 04:57:21,624 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 04:57:43,761 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 04:57:43,761 - __main__ - INFO -   First 5 values:
2025-07-03 04:57:43,762 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.200562
2025-07-03 04:57:43,762 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000134184.12'): 0.014008
2025-07-03 04:57:43,762 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000129824.15'): 0.084473
2025-07-03 04:57:43,762 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000134184.12'): 0.112122
2025-07-03 04:57:43,762 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000129824.15'): 0.017822
2025-07-03 04:57:43,762 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 04:57:43,762 - __main__ - INFO -   Index names: [None, None]
2025-07-03 05:01:24,107 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_brain_amygdala_var_pc_log2.pkl
2025-07-03 05:01:24,107 - __main__ - INFO -   Cache file size: 22543.12 MB
2025-07-03 05:01:24,378 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 05:01:27,538 - __main__ - INFO - Got aligned pearson series for brain_amygdala with 1313153128 values
2025-07-03 05:01:27,538 - __main__ - INFO - Combining 1313153128 gene pairs for brain_amygdala
2025-07-03 05:07:28,513 - __main__ - INFO - Successfully combined correlations for brain_amygdala into DataFrame with shape: (1313153128, 3)
2025-07-03 05:07:28,513 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 17544.5MB
2025-07-03 05:07:28,924 - __main__ - INFO - Saving combined correlations for brain_amygdala to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_amygdala-var_pc_log2-all.pkl
2025-07-03 05:07:28,925 - __main__ - INFO - Saving DataFrame with shape: (1313153128, 3), memory: 17544.5MB
2025-07-03 05:07:28,925 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 05:10:19,596 - __main__ - INFO - Results saved successfully. File size: 17533.8MB
2025-07-03 05:10:19,596 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 05:10:19,596 - __main__ - INFO - Successfully processed tissue: brain_amygdala
2025-07-03 05:10:19,596 - __main__ - INFO - Processing tissue: brain_anterior_cingulate_cortex_ba24
2025-07-03 05:10:19,596 - __main__ - INFO - All input files validated successfully for brain_anterior_cingulate_cortex_ba24
2025-07-03 05:10:19,596 - __main__ - INFO - Starting correlation combination process for brain_anterior_cingulate_cortex_ba24
2025-07-03 05:10:19,596 - __main__ - INFO - Loading gene expression data for brain_anterior_cingulate_cortex_ba24 from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_anterior_cingulate_cortex_ba24-var_pc_log2.pkl
2025-07-03 05:10:20,044 - __main__ - INFO - Loaded gene expression data for brain_anterior_cingulate_cortex_ba24 with shape: (56200, 176)
2025-07-03 05:10:20,044 - __main__ - INFO - Need to load and process for brain_anterior_cingulate_cortex_ba24: ccc_gpu, pearson, spearman
2025-07-03 05:10:20,044 - __main__ - INFO - No cache found for spearman in brain_anterior_cingulate_cortex_ba24, loading and processing matrix
2025-07-03 05:10:20,044 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_anterior_cingulate_cortex_ba24-var_pc_log2-spearman.pkl
2025-07-03 05:11:32,597 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 05:11:40,073 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 05:11:40,075 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 05:11:40,075 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 05:13:32,451 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 05:13:32,451 - __main__ - INFO - Processed spearman correlation matrix to series with 1345637503 values (dtype: float16)
2025-07-03 05:13:32,465 - __main__ - INFO - Processed spearman matrix for brain_anterior_cingulate_cortex_ba24 (reference):
2025-07-03 05:13:32,465 - __main__ - INFO -   Shape: (1345637503,)
2025-07-03 05:13:32,465 - __main__ - INFO -   Data type: float16
2025-07-03 05:13:40,795 - __main__ - INFO -   Memory usage: 12844.99 MB
2025-07-03 05:13:40,795 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 05:13:40,795 - __main__ - INFO - Caching aligned spearman matrix for brain_anterior_cingulate_cortex_ba24:
2025-07-03 05:13:40,795 - __main__ - INFO -   Shape: (1345637503,)
2025-07-03 05:13:40,795 - __main__ - INFO -   Data type: float16
2025-07-03 05:13:40,802 - __main__ - INFO -   Memory usage: 12844.99 MB
2025-07-03 05:13:48,948 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 05:14:11,303 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 05:14:11,304 - __main__ - INFO -   First 5 values:
2025-07-03 05:14:11,304 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.084839
2025-07-03 05:14:11,304 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.066162
2025-07-03 05:14:11,304 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.004280
2025-07-03 05:14:11,304 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000134184.12'): 0.012794
2025-07-03 05:14:11,304 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.042542
2025-07-03 05:14:11,304 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 05:14:11,304 - __main__ - INFO -   Index names: [None, None]
2025-07-03 05:20:34,490 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_anterior_cingulate_cortex_ba24_var_pc_log2.pkl
2025-07-03 05:20:34,490 - __main__ - INFO -   Cache file size: 23100.75 MB
2025-07-03 05:20:34,762 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 05:20:34,762 - __main__ - INFO - Using Spearman indices as reference for brain_anterior_cingulate_cortex_ba24: 1345637503 gene pairs
2025-07-03 05:20:34,762 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 05:20:34,762 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_anterior_cingulate_cortex_ba24-var_pc_log2-ccc_gpu.pkl
2025-07-03 05:21:04,373 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 05:21:18,121 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 05:21:18,123 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 05:21:18,123 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 05:24:25,873 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578140658 values (dtype: float16)
2025-07-03 05:24:25,887 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 05:24:25,887 - __main__ - INFO -   Original shape: (1578140658,)
2025-07-03 05:24:25,887 - __main__ - INFO -   Data type: float16
2025-07-03 05:24:35,628 - __main__ - INFO -   Memory usage: 15062.31 MB
2025-07-03 05:31:05,395 - __main__ - INFO - Alignment summary:
2025-07-03 05:31:05,395 - __main__ - INFO -   Aligned shape: (1345637503,)
2025-07-03 05:31:05,395 - __main__ - INFO -   Alignment ratio: 85.27% of original
2025-07-03 05:31:13,731 - __main__ - INFO -   Memory saved: 35241.32 MB
2025-07-03 05:31:13,731 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_anterior_cingulate_cortex_ba24:
2025-07-03 05:31:13,731 - __main__ - INFO -   Shape: (1345637503,)
2025-07-03 05:31:13,731 - __main__ - INFO -   Data type: float16
2025-07-03 05:31:13,738 - __main__ - INFO -   Memory usage: 12844.99 MB
2025-07-03 05:31:21,925 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 05:32:11,105 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 05:32:11,105 - __main__ - INFO -   First 5 values:
2025-07-03 05:32:11,105 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.023392
2025-07-03 05:32:11,105 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.018066
2025-07-03 05:32:11,105 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.009064
2025-07-03 05:32:11,105 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000134184.12'): 0.017319
2025-07-03 05:32:11,105 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.024094
2025-07-03 05:32:11,105 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 05:32:11,105 - __main__ - INFO -   Index names: [None, None]
2025-07-03 05:34:31,397 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_brain_anterior_cingulate_cortex_ba24_var_pc_log2.pkl
2025-07-03 05:34:31,397 - __main__ - INFO -   Cache file size: 23100.75 MB
2025-07-03 05:34:31,661 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 05:34:34,766 - __main__ - INFO - Got aligned ccc_gpu series for brain_anterior_cingulate_cortex_ba24 with 1345637503 values
2025-07-03 05:34:34,767 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 05:34:34,767 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_anterior_cingulate_cortex_ba24-var_pc_log2-pearson.pkl
2025-07-03 05:34:59,881 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 05:35:07,558 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 05:35:07,560 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 05:35:07,560 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 05:38:31,498 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 05:38:31,499 - __main__ - INFO - Processed pearson correlation matrix to series with 1345637503 values (dtype: float16)
2025-07-03 05:38:31,514 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 05:38:31,514 - __main__ - INFO -   Original shape: (1345637503,)
2025-07-03 05:38:31,514 - __main__ - INFO -   Data type: float16
2025-07-03 05:38:39,845 - __main__ - INFO -   Memory usage: 12844.99 MB
2025-07-03 05:45:04,396 - __main__ - INFO - Alignment summary:
2025-07-03 05:45:04,396 - __main__ - INFO -   Aligned shape: (1345637503,)
2025-07-03 05:45:04,396 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 05:45:12,736 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 05:45:12,736 - __main__ - INFO - Caching aligned pearson matrix for brain_anterior_cingulate_cortex_ba24:
2025-07-03 05:45:12,736 - __main__ - INFO -   Shape: (1345637503,)
2025-07-03 05:45:12,736 - __main__ - INFO -   Data type: float16
2025-07-03 05:45:12,742 - __main__ - INFO -   Memory usage: 12844.99 MB
2025-07-03 05:45:20,838 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 05:45:43,853 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 05:45:43,853 - __main__ - INFO -   First 5 values:
2025-07-03 05:45:43,853 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.072937
2025-07-03 05:45:43,853 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.035004
2025-07-03 05:45:43,853 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.009995
2025-07-03 05:45:43,853 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000134184.12'): 0.028854
2025-07-03 05:45:43,853 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.011528
2025-07-03 05:45:43,853 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 05:45:43,854 - __main__ - INFO -   Index names: [None, None]
2025-07-03 05:51:10,188 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_brain_anterior_cingulate_cortex_ba24_var_pc_log2.pkl
2025-07-03 05:51:10,188 - __main__ - INFO -   Cache file size: 23100.75 MB
2025-07-03 05:51:10,452 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 05:51:13,504 - __main__ - INFO - Got aligned pearson series for brain_anterior_cingulate_cortex_ba24 with 1345637503 values
2025-07-03 05:51:13,504 - __main__ - INFO - Combining 1345637503 gene pairs for brain_anterior_cingulate_cortex_ba24
2025-07-03 05:57:24,194 - __main__ - INFO - Successfully combined correlations for brain_anterior_cingulate_cortex_ba24 into DataFrame with shape: (1345637503, 3)
2025-07-03 05:57:24,194 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 17978.2MB
2025-07-03 05:57:24,641 - __main__ - INFO - Saving combined correlations for brain_anterior_cingulate_cortex_ba24 to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_anterior_cingulate_cortex_ba24-var_pc_log2-all.pkl
2025-07-03 05:57:24,641 - __main__ - INFO - Saving DataFrame with shape: (1345637503, 3), memory: 17978.2MB
2025-07-03 05:57:24,641 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 06:00:15,447 - __main__ - INFO - Results saved successfully. File size: 17967.6MB
2025-07-03 06:00:15,447 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 06:00:15,447 - __main__ - INFO - Successfully processed tissue: brain_anterior_cingulate_cortex_ba24
2025-07-03 06:00:15,447 - __main__ - INFO - Processing tissue: brain_caudate_basal_ganglia
2025-07-03 06:00:15,451 - __main__ - INFO - All input files validated successfully for brain_caudate_basal_ganglia
2025-07-03 06:00:15,451 - __main__ - INFO - Starting correlation combination process for brain_caudate_basal_ganglia
2025-07-03 06:00:15,451 - __main__ - INFO - Loading gene expression data for brain_caudate_basal_ganglia from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_caudate_basal_ganglia-var_pc_log2.pkl
2025-07-03 06:00:15,678 - __main__ - INFO - Loaded gene expression data for brain_caudate_basal_ganglia with shape: (56200, 246)
2025-07-03 06:00:15,678 - __main__ - INFO - Need to load and process for brain_caudate_basal_ganglia: ccc_gpu, pearson, spearman
2025-07-03 06:00:15,678 - __main__ - INFO - No cache found for spearman in brain_caudate_basal_ganglia, loading and processing matrix
2025-07-03 06:00:15,678 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_caudate_basal_ganglia-var_pc_log2-spearman.pkl
2025-07-03 06:01:33,209 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 06:01:40,754 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 06:01:40,755 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 06:01:40,756 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 06:03:27,113 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 06:03:27,115 - __main__ - INFO - Processed spearman correlation matrix to series with 1377836265 values (dtype: float16)
2025-07-03 06:03:27,128 - __main__ - INFO - Processed spearman matrix for brain_caudate_basal_ganglia (reference):
2025-07-03 06:03:27,128 - __main__ - INFO -   Shape: (1377836265,)
2025-07-03 06:03:27,128 - __main__ - INFO -   Data type: float16
2025-07-03 06:03:35,761 - __main__ - INFO -   Memory usage: 13152.06 MB
2025-07-03 06:03:35,761 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 06:03:35,761 - __main__ - INFO - Caching aligned spearman matrix for brain_caudate_basal_ganglia:
2025-07-03 06:03:35,761 - __main__ - INFO -   Shape: (1377836265,)
2025-07-03 06:03:35,761 - __main__ - INFO -   Data type: float16
2025-07-03 06:03:35,767 - __main__ - INFO -   Memory usage: 13152.06 MB
2025-07-03 06:03:44,147 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 06:04:08,143 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 06:04:08,143 - __main__ - INFO -   First 5 values:
2025-07-03 06:04:08,144 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.188477
2025-07-03 06:04:08,144 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000134184.12'): 0.239990
2025-07-03 06:04:08,144 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000129824.15'): 0.479736
2025-07-03 06:04:08,144 - __main__ - INFO -     ('ENSG00000160401.14', 'ENSG00000134184.12'): 0.132568
2025-07-03 06:04:08,144 - __main__ - INFO -     ('ENSG00000160401.14', 'ENSG00000129824.15'): 0.196289
2025-07-03 06:04:08,144 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 06:04:08,144 - __main__ - INFO -   Index names: [None, None]
2025-07-03 06:08:46,400 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_caudate_basal_ganglia_var_pc_log2.pkl
2025-07-03 06:08:46,400 - __main__ - INFO -   Cache file size: 23653.48 MB
2025-07-03 06:08:46,667 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 06:08:46,667 - __main__ - INFO - Using Spearman indices as reference for brain_caudate_basal_ganglia: 1377836265 gene pairs
2025-07-03 06:08:46,667 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 06:08:46,667 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_caudate_basal_ganglia-var_pc_log2-ccc_gpu.pkl
2025-07-03 06:09:17,070 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 06:09:34,124 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 06:09:34,126 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 06:09:34,126 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 06:12:19,944 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578305542 values (dtype: float16)
2025-07-03 06:12:19,959 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 06:12:19,959 - __main__ - INFO -   Original shape: (1578305542,)
2025-07-03 06:12:19,959 - __main__ - INFO -   Data type: float16
2025-07-03 06:12:29,677 - __main__ - INFO -   Memory usage: 15063.88 MB
2025-07-03 06:19:08,947 - __main__ - INFO - Alignment summary:
2025-07-03 06:19:08,947 - __main__ - INFO -   Aligned shape: (1377836265,)
2025-07-03 06:19:08,947 - __main__ - INFO -   Alignment ratio: 87.30% of original
2025-07-03 06:19:17,417 - __main__ - INFO -   Memory saved: 34935.82 MB
2025-07-03 06:19:17,417 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_caudate_basal_ganglia:
2025-07-03 06:19:17,417 - __main__ - INFO -   Shape: (1377836265,)
2025-07-03 06:19:17,417 - __main__ - INFO -   Data type: float16
2025-07-03 06:19:17,424 - __main__ - INFO -   Memory usage: 13152.06 MB
2025-07-03 06:19:25,807 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 06:20:17,609 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 06:20:17,609 - __main__ - INFO -   First 5 values:
2025-07-03 06:20:17,609 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.028229
2025-07-03 06:20:17,609 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000134184.12'): 0.027496
2025-07-03 06:20:17,609 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000129824.15'): 0.226929
2025-07-03 06:20:17,609 - __main__ - INFO -     ('ENSG00000160401.14', 'ENSG00000134184.12'): 0.008949
2025-07-03 06:20:17,609 - __main__ - INFO -     ('ENSG00000160401.14', 'ENSG00000129824.15'): 0.034668
2025-07-03 06:20:17,609 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 06:20:17,609 - __main__ - INFO -   Index names: [None, None]
2025-07-03 06:23:38,805 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_brain_caudate_basal_ganglia_var_pc_log2.pkl
2025-07-03 06:23:38,805 - __main__ - INFO -   Cache file size: 23653.48 MB
2025-07-03 06:23:39,053 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 06:23:42,033 - __main__ - INFO - Got aligned ccc_gpu series for brain_caudate_basal_ganglia with 1377836265 values
2025-07-03 06:23:42,033 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 06:23:42,033 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_caudate_basal_ganglia-var_pc_log2-pearson.pkl
2025-07-03 06:24:11,373 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 06:24:19,144 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 06:24:19,145 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 06:24:19,146 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 06:27:39,037 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 06:27:39,038 - __main__ - INFO - Processed pearson correlation matrix to series with 1377836265 values (dtype: float16)
2025-07-03 06:27:39,052 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 06:27:39,052 - __main__ - INFO -   Original shape: (1377836265,)
2025-07-03 06:27:39,052 - __main__ - INFO -   Data type: float16
2025-07-03 06:27:47,579 - __main__ - INFO -   Memory usage: 13152.06 MB
2025-07-03 06:34:17,449 - __main__ - INFO - Alignment summary:
2025-07-03 06:34:17,450 - __main__ - INFO -   Aligned shape: (1377836265,)
2025-07-03 06:34:17,451 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 06:34:25,890 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 06:34:25,891 - __main__ - INFO - Caching aligned pearson matrix for brain_caudate_basal_ganglia:
2025-07-03 06:34:25,891 - __main__ - INFO -   Shape: (1377836265,)
2025-07-03 06:34:25,891 - __main__ - INFO -   Data type: float16
2025-07-03 06:34:25,897 - __main__ - INFO -   Memory usage: 13152.06 MB
2025-07-03 06:34:34,215 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 06:34:58,800 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 06:34:58,800 - __main__ - INFO -   First 5 values:
2025-07-03 06:34:58,802 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.164795
2025-07-03 06:34:58,802 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000134184.12'): 0.136230
2025-07-03 06:34:58,802 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000129824.15'): 0.335205
2025-07-03 06:34:58,802 - __main__ - INFO -     ('ENSG00000160401.14', 'ENSG00000134184.12'): 0.069519
2025-07-03 06:34:58,802 - __main__ - INFO -     ('ENSG00000160401.14', 'ENSG00000129824.15'): 0.081482
2025-07-03 06:34:58,802 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 06:34:58,802 - __main__ - INFO -   Index names: [None, None]
2025-07-03 06:38:19,722 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_brain_caudate_basal_ganglia_var_pc_log2.pkl
2025-07-03 06:38:19,722 - __main__ - INFO -   Cache file size: 23653.48 MB
2025-07-03 06:38:19,990 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 06:38:23,019 - __main__ - INFO - Got aligned pearson series for brain_caudate_basal_ganglia with 1377836265 values
2025-07-03 06:38:23,019 - __main__ - INFO - Combining 1377836265 gene pairs for brain_caudate_basal_ganglia
2025-07-03 06:44:46,591 - __main__ - INFO - Successfully combined correlations for brain_caudate_basal_ganglia into DataFrame with shape: (1377836265, 3)
2025-07-03 06:44:46,592 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 18408.1MB
2025-07-03 06:44:47,015 - __main__ - INFO - Saving combined correlations for brain_caudate_basal_ganglia to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_caudate_basal_ganglia-var_pc_log2-all.pkl
2025-07-03 06:44:47,015 - __main__ - INFO - Saving DataFrame with shape: (1377836265, 3), memory: 18408.1MB
2025-07-03 06:44:47,015 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 06:46:47,214 - __main__ - INFO - Results saved successfully. File size: 18397.5MB
2025-07-03 06:46:47,214 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 06:46:47,214 - __main__ - INFO - Successfully processed tissue: brain_caudate_basal_ganglia
2025-07-03 06:46:47,214 - __main__ - INFO - Processing tissue: brain_cerebellar_hemisphere
2025-07-03 06:46:47,239 - __main__ - INFO - All input files validated successfully for brain_cerebellar_hemisphere
2025-07-03 06:46:47,239 - __main__ - INFO - Starting correlation combination process for brain_cerebellar_hemisphere
2025-07-03 06:46:47,240 - __main__ - INFO - Loading gene expression data for brain_cerebellar_hemisphere from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_cerebellar_hemisphere-var_pc_log2.pkl
2025-07-03 06:46:48,067 - __main__ - INFO - Loaded gene expression data for brain_cerebellar_hemisphere with shape: (56200, 215)
2025-07-03 06:46:48,067 - __main__ - INFO - Need to load and process for brain_cerebellar_hemisphere: ccc_gpu, pearson, spearman
2025-07-03 06:46:48,067 - __main__ - INFO - No cache found for spearman in brain_cerebellar_hemisphere, loading and processing matrix
2025-07-03 06:46:48,067 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cerebellar_hemisphere-var_pc_log2-spearman.pkl
2025-07-03 06:47:17,592 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 06:47:25,130 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 06:47:25,132 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 06:47:25,132 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 06:49:04,352 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 06:49:04,352 - __main__ - INFO - Processed spearman correlation matrix to series with 1357283151 values (dtype: float16)
2025-07-03 06:49:04,365 - __main__ - INFO - Processed spearman matrix for brain_cerebellar_hemisphere (reference):
2025-07-03 06:49:04,366 - __main__ - INFO -   Shape: (1357283151,)
2025-07-03 06:49:04,366 - __main__ - INFO -   Data type: float16
2025-07-03 06:49:12,744 - __main__ - INFO -   Memory usage: 12956.05 MB
2025-07-03 06:49:12,744 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 06:49:12,744 - __main__ - INFO - Caching aligned spearman matrix for brain_cerebellar_hemisphere:
2025-07-03 06:49:12,744 - __main__ - INFO -   Shape: (1357283151,)
2025-07-03 06:49:12,745 - __main__ - INFO -   Data type: float16
2025-07-03 06:49:12,751 - __main__ - INFO -   Memory usage: 12956.05 MB
2025-07-03 06:49:20,967 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 06:49:45,132 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 06:49:45,132 - __main__ - INFO -   First 5 values:
2025-07-03 06:49:45,133 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.777344
2025-07-03 06:49:45,133 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000129824.15'): 0.784668
2025-07-03 06:49:45,133 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000067048.16'): 0.905273
2025-07-03 06:49:45,133 - __main__ - INFO -     ('ENSG00000174576.9', 'ENSG00000129824.15'): 0.141479
2025-07-03 06:49:45,133 - __main__ - INFO -     ('ENSG00000174576.9', 'ENSG00000067048.16'): 0.069336
2025-07-03 06:49:45,133 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 06:49:45,133 - __main__ - INFO -   Index names: [None, None]
2025-07-03 06:53:16,866 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_cerebellar_hemisphere_var_pc_log2.pkl
2025-07-03 06:53:16,866 - __main__ - INFO -   Cache file size: 23300.66 MB
2025-07-03 06:53:17,140 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 06:53:17,140 - __main__ - INFO - Using Spearman indices as reference for brain_cerebellar_hemisphere: 1357283151 gene pairs
2025-07-03 06:53:17,140 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 06:53:17,141 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cerebellar_hemisphere-var_pc_log2-ccc_gpu.pkl
2025-07-03 06:54:25,673 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 06:54:39,467 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 06:54:39,468 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 06:54:39,469 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 06:57:39,727 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578201303 values (dtype: float16)
2025-07-03 06:57:39,743 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 06:57:39,743 - __main__ - INFO -   Original shape: (1578201303,)
2025-07-03 06:57:39,743 - __main__ - INFO -   Data type: float16
2025-07-03 06:57:49,501 - __main__ - INFO -   Memory usage: 15062.89 MB
2025-07-03 07:04:26,991 - __main__ - INFO - Alignment summary:
2025-07-03 07:04:26,991 - __main__ - INFO -   Aligned shape: (1357283151,)
2025-07-03 07:04:26,991 - __main__ - INFO -   Alignment ratio: 86.00% of original
2025-07-03 07:04:35,365 - __main__ - INFO -   Memory saved: 35130.84 MB
2025-07-03 07:04:35,365 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_cerebellar_hemisphere:
2025-07-03 07:04:35,365 - __main__ - INFO -   Shape: (1357283151,)
2025-07-03 07:04:35,365 - __main__ - INFO -   Data type: float16
2025-07-03 07:04:35,372 - __main__ - INFO -   Memory usage: 12956.05 MB
2025-07-03 07:04:43,592 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 07:05:35,734 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 07:05:35,734 - __main__ - INFO -   First 5 values:
2025-07-03 07:05:35,734 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.465088
2025-07-03 07:05:35,734 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000129824.15'): 0.457520
2025-07-03 07:05:35,734 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000067048.16'): 0.607910
2025-07-03 07:05:35,734 - __main__ - INFO -     ('ENSG00000174576.9', 'ENSG00000129824.15'): 0.015945
2025-07-03 07:05:35,734 - __main__ - INFO -     ('ENSG00000174576.9', 'ENSG00000067048.16'): 0.032227
2025-07-03 07:05:35,734 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 07:05:35,734 - __main__ - INFO -   Index names: [None, None]
2025-07-03 07:10:20,503 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_brain_cerebellar_hemisphere_var_pc_log2.pkl
2025-07-03 07:10:20,503 - __main__ - INFO -   Cache file size: 23300.66 MB
2025-07-03 07:10:20,776 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 07:10:23,757 - __main__ - INFO - Got aligned ccc_gpu series for brain_cerebellar_hemisphere with 1357283151 values
2025-07-03 07:10:23,757 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 07:10:23,757 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cerebellar_hemisphere-var_pc_log2-pearson.pkl
2025-07-03 07:10:53,124 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 07:11:00,543 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 07:11:00,544 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 07:11:00,544 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 07:14:21,697 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 07:14:21,699 - __main__ - INFO - Processed pearson correlation matrix to series with 1357283151 values (dtype: float16)
2025-07-03 07:14:21,713 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 07:14:21,713 - __main__ - INFO -   Original shape: (1357283151,)
2025-07-03 07:14:21,713 - __main__ - INFO -   Data type: float16
2025-07-03 07:14:30,099 - __main__ - INFO -   Memory usage: 12956.05 MB
2025-07-03 07:20:55,968 - __main__ - INFO - Alignment summary:
2025-07-03 07:20:55,968 - __main__ - INFO -   Aligned shape: (1357283151,)
2025-07-03 07:20:55,968 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 07:21:04,319 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 07:21:04,320 - __main__ - INFO - Caching aligned pearson matrix for brain_cerebellar_hemisphere:
2025-07-03 07:21:04,320 - __main__ - INFO -   Shape: (1357283151,)
2025-07-03 07:21:04,320 - __main__ - INFO -   Data type: float16
2025-07-03 07:21:04,326 - __main__ - INFO -   Memory usage: 12956.05 MB
2025-07-03 07:21:12,516 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 07:21:36,829 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 07:21:36,829 - __main__ - INFO -   First 5 values:
2025-07-03 07:21:36,831 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.731445
2025-07-03 07:21:36,831 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000129824.15'): 0.888184
2025-07-03 07:21:36,831 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000067048.16'): 0.824219
2025-07-03 07:21:36,831 - __main__ - INFO -     ('ENSG00000174576.9', 'ENSG00000129824.15'): 0.075073
2025-07-03 07:21:36,831 - __main__ - INFO -     ('ENSG00000174576.9', 'ENSG00000067048.16'): 0.032562
2025-07-03 07:21:36,831 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 07:21:36,831 - __main__ - INFO -   Index names: [None, None]
2025-07-03 07:26:55,345 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_brain_cerebellar_hemisphere_var_pc_log2.pkl
2025-07-03 07:26:55,345 - __main__ - INFO -   Cache file size: 23300.66 MB
2025-07-03 07:26:55,621 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 07:26:58,648 - __main__ - INFO - Got aligned pearson series for brain_cerebellar_hemisphere with 1357283151 values
2025-07-03 07:26:58,648 - __main__ - INFO - Combining 1357283151 gene pairs for brain_cerebellar_hemisphere
2025-07-03 07:33:08,472 - __main__ - INFO - Successfully combined correlations for brain_cerebellar_hemisphere into DataFrame with shape: (1357283151, 3)
2025-07-03 07:33:08,472 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 18133.7MB
2025-07-03 07:33:08,920 - __main__ - INFO - Saving combined correlations for brain_cerebellar_hemisphere to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cerebellar_hemisphere-var_pc_log2-all.pkl
2025-07-03 07:33:08,920 - __main__ - INFO - Saving DataFrame with shape: (1357283151, 3), memory: 18133.7MB
2025-07-03 07:33:08,920 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 07:36:14,993 - __main__ - INFO - Results saved successfully. File size: 18123.0MB
2025-07-03 07:36:14,993 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 07:36:14,993 - __main__ - INFO - Successfully processed tissue: brain_cerebellar_hemisphere
2025-07-03 07:36:14,993 - __main__ - INFO - Processing tissue: brain_cerebellum
2025-07-03 07:36:15,008 - __main__ - INFO - All input files validated successfully for brain_cerebellum
2025-07-03 07:36:15,008 - __main__ - INFO - Starting correlation combination process for brain_cerebellum
2025-07-03 07:36:15,008 - __main__ - INFO - Loading gene expression data for brain_cerebellum from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_cerebellum-var_pc_log2.pkl
2025-07-03 07:36:15,957 - __main__ - INFO - Loaded gene expression data for brain_cerebellum with shape: (56200, 241)
2025-07-03 07:36:15,957 - __main__ - INFO - Need to load and process for brain_cerebellum: ccc_gpu, pearson, spearman
2025-07-03 07:36:15,957 - __main__ - INFO - No cache found for spearman in brain_cerebellum, loading and processing matrix
2025-07-03 07:36:15,957 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cerebellum-var_pc_log2-spearman.pkl
2025-07-03 07:36:45,744 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 07:36:53,341 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 07:36:53,342 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 07:36:53,342 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 07:38:37,437 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 07:38:37,437 - __main__ - INFO - Processed spearman correlation matrix to series with 1373692320 values (dtype: float16)
2025-07-03 07:38:37,451 - __main__ - INFO - Processed spearman matrix for brain_cerebellum (reference):
2025-07-03 07:38:37,451 - __main__ - INFO -   Shape: (1373692320,)
2025-07-03 07:38:37,451 - __main__ - INFO -   Data type: float16
2025-07-03 07:38:45,954 - __main__ - INFO -   Memory usage: 13112.54 MB
2025-07-03 07:38:45,954 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 07:38:45,954 - __main__ - INFO - Caching aligned spearman matrix for brain_cerebellum:
2025-07-03 07:38:45,954 - __main__ - INFO -   Shape: (1373692320,)
2025-07-03 07:38:45,954 - __main__ - INFO -   Data type: float16
2025-07-03 07:38:45,961 - __main__ - INFO -   Memory usage: 13112.54 MB
2025-07-03 07:38:54,274 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 07:39:19,313 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 07:39:19,313 - __main__ - INFO -   First 5 values:
2025-07-03 07:39:19,313 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.556152
2025-07-03 07:39:19,313 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.811523
2025-07-03 07:39:19,313 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000229807.10'): 0.519043
2025-07-03 07:39:19,313 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000129824.15'): 0.869141
2025-07-03 07:39:19,313 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000229807.10'): 0.518555
2025-07-03 07:39:19,313 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 07:39:19,314 - __main__ - INFO -   Index names: [None, None]
2025-07-03 07:45:33,368 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_cerebellum_var_pc_log2.pkl
2025-07-03 07:45:33,368 - __main__ - INFO -   Cache file size: 23582.34 MB
2025-07-03 07:45:33,614 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 07:45:33,615 - __main__ - INFO - Using Spearman indices as reference for brain_cerebellum: 1373692320 gene pairs
2025-07-03 07:45:33,615 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 07:45:33,615 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cerebellum-var_pc_log2-ccc_gpu.pkl
2025-07-03 07:46:18,451 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 07:46:33,448 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 07:46:33,449 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 07:46:33,450 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 07:49:29,534 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578284765 values (dtype: float16)
2025-07-03 07:49:29,548 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 07:49:29,548 - __main__ - INFO -   Original shape: (1578284765,)
2025-07-03 07:49:29,548 - __main__ - INFO -   Data type: float16
2025-07-03 07:49:39,308 - __main__ - INFO -   Memory usage: 15063.68 MB
2025-07-03 07:56:22,491 - __main__ - INFO - Alignment summary:
2025-07-03 07:56:22,491 - __main__ - INFO -   Aligned shape: (1373692320,)
2025-07-03 07:56:22,491 - __main__ - INFO -   Alignment ratio: 87.04% of original
2025-07-03 07:56:30,989 - __main__ - INFO -   Memory saved: 34975.15 MB
2025-07-03 07:56:30,989 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_cerebellum:
2025-07-03 07:56:30,991 - __main__ - INFO -   Shape: (1373692320,)
2025-07-03 07:56:30,991 - __main__ - INFO -   Data type: float16
2025-07-03 07:56:30,997 - __main__ - INFO -   Memory usage: 13112.54 MB
2025-07-03 07:56:39,351 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 07:57:35,016 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 07:57:35,016 - __main__ - INFO -   First 5 values:
2025-07-03 07:57:35,016 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.291016
2025-07-03 07:57:35,016 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.513184
2025-07-03 07:57:35,016 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000229807.10'): 0.304688
2025-07-03 07:57:35,016 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000129824.15'): 0.565430
2025-07-03 07:57:35,016 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000229807.10'): 0.320801
2025-07-03 07:57:35,016 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 07:57:35,016 - __main__ - INFO -   Index names: [None, None]
2025-07-03 08:02:19,333 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_brain_cerebellum_var_pc_log2.pkl
2025-07-03 08:02:19,333 - __main__ - INFO -   Cache file size: 23582.34 MB
2025-07-03 08:02:19,606 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 08:02:22,632 - __main__ - INFO - Got aligned ccc_gpu series for brain_cerebellum with 1373692320 values
2025-07-03 08:02:22,632 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 08:02:22,632 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cerebellum-var_pc_log2-pearson.pkl
2025-07-03 08:02:46,963 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 08:02:54,689 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 08:02:54,691 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 08:02:54,691 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 08:06:27,284 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 08:06:27,286 - __main__ - INFO - Processed pearson correlation matrix to series with 1373692320 values (dtype: float16)
2025-07-03 08:06:27,300 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 08:06:27,300 - __main__ - INFO -   Original shape: (1373692320,)
2025-07-03 08:06:27,300 - __main__ - INFO -   Data type: float16
2025-07-03 08:06:35,803 - __main__ - INFO -   Memory usage: 13112.54 MB
2025-07-03 08:13:08,957 - __main__ - INFO - Alignment summary:
2025-07-03 08:13:08,957 - __main__ - INFO -   Aligned shape: (1373692320,)
2025-07-03 08:13:08,957 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 08:13:17,412 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 08:13:17,412 - __main__ - INFO - Caching aligned pearson matrix for brain_cerebellum:
2025-07-03 08:13:17,412 - __main__ - INFO -   Shape: (1373692320,)
2025-07-03 08:13:17,413 - __main__ - INFO -   Data type: float16
2025-07-03 08:13:17,419 - __main__ - INFO -   Memory usage: 13112.54 MB
2025-07-03 08:13:25,701 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 08:13:50,745 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 08:13:50,745 - __main__ - INFO -   First 5 values:
2025-07-03 08:13:50,745 - __main__ - INFO -     ('ENSG00000229807.10', 'ENSG00000129824.15'): 0.773438
2025-07-03 08:13:50,745 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000129824.15'): 0.840820
2025-07-03 08:13:50,745 - __main__ - INFO -     ('ENSG00000067048.16', 'ENSG00000229807.10'): 0.691406
2025-07-03 08:13:50,745 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000129824.15'): 0.957031
2025-07-03 08:13:50,745 - __main__ - INFO -     ('ENSG00000012817.15', 'ENSG00000229807.10'): 0.776855
2025-07-03 08:13:50,745 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 08:13:50,745 - __main__ - INFO -   Index names: [None, None]
2025-07-03 08:17:15,366 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_brain_cerebellum_var_pc_log2.pkl
2025-07-03 08:17:15,366 - __main__ - INFO -   Cache file size: 23582.34 MB
2025-07-03 08:17:15,640 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 08:17:18,800 - __main__ - INFO - Got aligned pearson series for brain_cerebellum with 1373692320 values
2025-07-03 08:17:18,801 - __main__ - INFO - Combining 1373692320 gene pairs for brain_cerebellum
2025-07-03 08:23:36,684 - __main__ - INFO - Successfully combined correlations for brain_cerebellum into DataFrame with shape: (1373692320, 3)
2025-07-03 08:23:36,684 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 18352.8MB
2025-07-03 08:23:37,142 - __main__ - INFO - Saving combined correlations for brain_cerebellum to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cerebellum-var_pc_log2-all.pkl
2025-07-03 08:23:37,142 - __main__ - INFO - Saving DataFrame with shape: (1373692320, 3), memory: 18352.8MB
2025-07-03 08:23:37,142 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 08:26:25,054 - __main__ - INFO - Results saved successfully. File size: 18342.1MB
2025-07-03 08:26:25,055 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 08:26:25,055 - __main__ - INFO - Successfully processed tissue: brain_cerebellum
2025-07-03 08:26:25,055 - __main__ - INFO - Processing tissue: brain_cortex
2025-07-03 08:26:25,089 - __main__ - INFO - All input files validated successfully for brain_cortex
2025-07-03 08:26:25,090 - __main__ - INFO - Starting correlation combination process for brain_cortex
2025-07-03 08:26:25,090 - __main__ - INFO - Loading gene expression data for brain_cortex from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_cortex-var_pc_log2.pkl
2025-07-03 08:26:26,378 - __main__ - INFO - Loaded gene expression data for brain_cortex with shape: (56200, 255)
2025-07-03 08:26:26,378 - __main__ - INFO - Need to load and process for brain_cortex: ccc_gpu, pearson, spearman
2025-07-03 08:26:26,378 - __main__ - INFO - No cache found for spearman in brain_cortex, loading and processing matrix
2025-07-03 08:26:26,378 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cortex-var_pc_log2-spearman.pkl
2025-07-03 08:26:54,036 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 08:27:01,558 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 08:27:01,559 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 08:27:01,560 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 08:28:40,370 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 08:28:40,372 - __main__ - INFO - Processed spearman correlation matrix to series with 1428371076 values (dtype: float16)
2025-07-03 08:28:40,386 - __main__ - INFO - Processed spearman matrix for brain_cortex (reference):
2025-07-03 08:28:40,386 - __main__ - INFO -   Shape: (1428371076,)
2025-07-03 08:28:40,387 - __main__ - INFO -   Data type: float16
2025-07-03 08:28:49,239 - __main__ - INFO -   Memory usage: 13634.00 MB
2025-07-03 08:28:49,239 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 08:28:49,239 - __main__ - INFO - Caching aligned spearman matrix for brain_cortex:
2025-07-03 08:28:49,239 - __main__ - INFO -   Shape: (1428371076,)
2025-07-03 08:28:49,239 - __main__ - INFO -   Data type: float16
2025-07-03 08:28:49,246 - __main__ - INFO -   Memory usage: 13634.00 MB
2025-07-03 08:28:57,884 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 08:29:22,850 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 08:29:22,850 - __main__ - INFO -   First 5 values:
2025-07-03 08:29:22,850 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.005623
2025-07-03 08:29:22,850 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.015961
2025-07-03 08:29:22,850 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.034882
2025-07-03 08:29:22,850 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000134184.12'): 0.020325
2025-07-03 08:29:22,850 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.116516
2025-07-03 08:29:22,850 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 08:29:22,850 - __main__ - INFO -   Index names: [None, None]
2025-07-03 08:31:44,366 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_cortex_var_pc_log2.pkl
2025-07-03 08:31:44,366 - __main__ - INFO -   Cache file size: 24520.97 MB
2025-07-03 08:31:44,641 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 08:31:44,641 - __main__ - INFO - Using Spearman indices as reference for brain_cortex: 1428371076 gene pairs
2025-07-03 08:31:44,641 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 08:31:44,641 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cortex-var_pc_log2-ccc_gpu.pkl
2025-07-03 08:33:53,252 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 08:34:09,090 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 08:34:09,091 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 08:34:09,092 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 08:37:14,575 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578547266 values (dtype: float16)
2025-07-03 08:37:14,590 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 08:37:14,590 - __main__ - INFO -   Original shape: (1578547266,)
2025-07-03 08:37:14,590 - __main__ - INFO -   Data type: float16
2025-07-03 08:37:24,356 - __main__ - INFO -   Memory usage: 15066.19 MB
2025-07-03 08:44:14,235 - __main__ - INFO - Alignment summary:
2025-07-03 08:44:14,235 - __main__ - INFO -   Aligned shape: (1428371076,)
2025-07-03 08:44:14,235 - __main__ - INFO -   Alignment ratio: 90.49% of original
2025-07-03 08:44:23,079 - __main__ - INFO -   Memory saved: 34456.19 MB
2025-07-03 08:44:23,079 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_cortex:
2025-07-03 08:44:23,079 - __main__ - INFO -   Shape: (1428371076,)
2025-07-03 08:44:23,079 - __main__ - INFO -   Data type: float16
2025-07-03 08:44:23,086 - __main__ - INFO -   Memory usage: 13634.00 MB
2025-07-03 08:44:31,768 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 08:45:29,001 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 08:45:29,002 - __main__ - INFO -   First 5 values:
2025-07-03 08:45:29,002 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.013107
2025-07-03 08:45:29,002 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.005913
2025-07-03 08:45:29,002 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.020325
2025-07-03 08:45:29,002 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000134184.12'): 0.013748
2025-07-03 08:45:29,002 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.026321
2025-07-03 08:45:29,002 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 08:45:29,002 - __main__ - INFO -   Index names: [None, None]
2025-07-03 08:49:11,350 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_brain_cortex_var_pc_log2.pkl
2025-07-03 08:49:11,351 - __main__ - INFO -   Cache file size: 24520.97 MB
2025-07-03 08:49:11,615 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 08:49:14,674 - __main__ - INFO - Got aligned ccc_gpu series for brain_cortex with 1428371076 values
2025-07-03 08:49:14,674 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 08:49:14,674 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cortex-var_pc_log2-pearson.pkl
2025-07-03 08:49:43,184 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 08:49:50,947 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 08:49:50,948 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 08:49:50,949 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 08:53:24,259 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 08:53:24,261 - __main__ - INFO - Processed pearson correlation matrix to series with 1428371076 values (dtype: float16)
2025-07-03 08:53:24,275 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 08:53:24,275 - __main__ - INFO -   Original shape: (1428371076,)
2025-07-03 08:53:24,276 - __main__ - INFO -   Data type: float16
2025-07-03 08:53:33,143 - __main__ - INFO -   Memory usage: 13634.00 MB
2025-07-03 09:00:12,567 - __main__ - INFO - Alignment summary:
2025-07-03 09:00:12,567 - __main__ - INFO -   Aligned shape: (1428371076,)
2025-07-03 09:00:12,567 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 09:00:21,375 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 09:00:21,375 - __main__ - INFO - Caching aligned pearson matrix for brain_cortex:
2025-07-03 09:00:21,375 - __main__ - INFO -   Shape: (1428371076,)
2025-07-03 09:00:21,375 - __main__ - INFO -   Data type: float16
2025-07-03 09:00:21,382 - __main__ - INFO -   Memory usage: 13634.00 MB
2025-07-03 09:00:29,963 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 09:00:56,070 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 09:00:56,070 - __main__ - INFO -   First 5 values:
2025-07-03 09:00:56,072 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.062927
2025-07-03 09:00:56,072 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.049286
2025-07-03 09:00:56,072 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.107605
2025-07-03 09:00:56,072 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000134184.12'): 0.073669
2025-07-03 09:00:56,072 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.082275
2025-07-03 09:00:56,072 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 09:00:56,072 - __main__ - INFO -   Index names: [None, None]
2025-07-03 09:06:16,189 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_brain_cortex_var_pc_log2.pkl
2025-07-03 09:06:16,190 - __main__ - INFO -   Cache file size: 24520.97 MB
2025-07-03 09:06:16,466 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 09:06:19,530 - __main__ - INFO - Got aligned pearson series for brain_cortex with 1428371076 values
2025-07-03 09:06:19,530 - __main__ - INFO - Combining 1428371076 gene pairs for brain_cortex
2025-07-03 09:12:56,228 - __main__ - INFO - Successfully combined correlations for brain_cortex into DataFrame with shape: (1428371076, 3)
2025-07-03 09:12:56,229 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 19082.8MB
2025-07-03 09:12:56,686 - __main__ - INFO - Saving combined correlations for brain_cortex to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_cortex-var_pc_log2-all.pkl
2025-07-03 09:12:56,686 - __main__ - INFO - Saving DataFrame with shape: (1428371076, 3), memory: 19082.8MB
2025-07-03 09:12:56,686 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 09:14:51,113 - __main__ - INFO - Results saved successfully. File size: 19072.2MB
2025-07-03 09:14:51,113 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 09:14:51,113 - __main__ - INFO - Successfully processed tissue: brain_cortex
2025-07-03 09:14:51,113 - __main__ - INFO - Processing tissue: brain_frontal_cortex_ba9
2025-07-03 09:14:51,116 - __main__ - INFO - All input files validated successfully for brain_frontal_cortex_ba9
2025-07-03 09:14:51,116 - __main__ - INFO - Starting correlation combination process for brain_frontal_cortex_ba9
2025-07-03 09:14:51,116 - __main__ - INFO - Loading gene expression data for brain_frontal_cortex_ba9 from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_frontal_cortex_ba9-var_pc_log2.pkl
2025-07-03 09:14:51,529 - __main__ - INFO - Loaded gene expression data for brain_frontal_cortex_ba9 with shape: (56200, 209)
2025-07-03 09:14:51,529 - __main__ - INFO - Need to load and process for brain_frontal_cortex_ba9: ccc_gpu, pearson, spearman
2025-07-03 09:14:51,529 - __main__ - INFO - No cache found for spearman in brain_frontal_cortex_ba9, loading and processing matrix
2025-07-03 09:14:51,529 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_frontal_cortex_ba9-var_pc_log2-spearman.pkl
2025-07-03 09:15:16,392 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 09:15:23,905 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 09:15:23,906 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 09:15:23,907 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 09:17:02,826 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 09:17:02,826 - __main__ - INFO - Processed spearman correlation matrix to series with 1359576585 values (dtype: float16)
2025-07-03 09:17:02,840 - __main__ - INFO - Processed spearman matrix for brain_frontal_cortex_ba9 (reference):
2025-07-03 09:17:02,840 - __main__ - INFO -   Shape: (1359576585,)
2025-07-03 09:17:02,840 - __main__ - INFO -   Data type: float16
2025-07-03 09:17:11,165 - __main__ - INFO -   Memory usage: 12977.92 MB
2025-07-03 09:17:11,165 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 09:17:11,165 - __main__ - INFO - Caching aligned spearman matrix for brain_frontal_cortex_ba9:
2025-07-03 09:17:11,165 - __main__ - INFO -   Shape: (1359576585,)
2025-07-03 09:17:11,165 - __main__ - INFO -   Data type: float16
2025-07-03 09:17:11,172 - __main__ - INFO -   Memory usage: 12977.92 MB
2025-07-03 09:17:19,303 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 09:17:42,966 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 09:17:42,967 - __main__ - INFO -   First 5 values:
2025-07-03 09:17:42,967 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.029633
2025-07-03 09:17:42,967 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.008209
2025-07-03 09:17:42,967 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.102478
2025-07-03 09:17:42,967 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000134184.12'): 0.133179
2025-07-03 09:17:42,967 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000129824.15'): 0.081848
2025-07-03 09:17:42,967 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 09:17:42,967 - __main__ - INFO -   Index names: [None, None]
2025-07-03 09:21:14,886 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_frontal_cortex_ba9_var_pc_log2.pkl
2025-07-03 09:21:14,886 - __main__ - INFO -   Cache file size: 23340.03 MB
2025-07-03 09:21:15,157 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 09:21:15,158 - __main__ - INFO - Using Spearman indices as reference for brain_frontal_cortex_ba9: 1359576585 gene pairs
2025-07-03 09:21:15,158 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 09:21:15,158 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_frontal_cortex_ba9-var_pc_log2-ccc_gpu.pkl
2025-07-03 09:21:47,667 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 09:22:02,889 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 09:22:02,890 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 09:22:02,890 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 09:24:55,009 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578213095 values (dtype: float16)
2025-07-03 09:24:55,023 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 09:24:55,023 - __main__ - INFO -   Original shape: (1578213095,)
2025-07-03 09:24:55,024 - __main__ - INFO -   Data type: float16
2025-07-03 09:25:04,858 - __main__ - INFO -   Memory usage: 15063.00 MB
2025-07-03 09:31:42,465 - __main__ - INFO - Alignment summary:
2025-07-03 09:31:42,465 - __main__ - INFO -   Aligned shape: (1359576585,)
2025-07-03 09:31:42,465 - __main__ - INFO -   Alignment ratio: 86.15% of original
2025-07-03 09:31:50,828 - __main__ - INFO -   Memory saved: 35109.08 MB
2025-07-03 09:31:50,828 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_frontal_cortex_ba9:
2025-07-03 09:31:50,828 - __main__ - INFO -   Shape: (1359576585,)
2025-07-03 09:31:50,828 - __main__ - INFO -   Data type: float16
2025-07-03 09:31:50,835 - __main__ - INFO -   Memory usage: 12977.92 MB
2025-07-03 09:31:59,100 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 09:32:51,250 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 09:32:51,250 - __main__ - INFO -   First 5 values:
2025-07-03 09:32:51,250 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.015915
2025-07-03 09:32:51,250 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.010536
2025-07-03 09:32:51,250 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.023834
2025-07-03 09:32:51,250 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000134184.12'): 0.037079
2025-07-03 09:32:51,250 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000129824.15'): 0.008957
2025-07-03 09:32:51,250 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 09:32:51,250 - __main__ - INFO -   Index names: [None, None]
2025-07-03 09:39:07,609 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_brain_frontal_cortex_ba9_var_pc_log2.pkl
2025-07-03 09:39:07,609 - __main__ - INFO -   Cache file size: 23340.03 MB
2025-07-03 09:39:07,868 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 09:39:10,829 - __main__ - INFO - Got aligned ccc_gpu series for brain_frontal_cortex_ba9 with 1359576585 values
2025-07-03 09:39:10,829 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 09:39:10,829 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_frontal_cortex_ba9-var_pc_log2-pearson.pkl
2025-07-03 09:39:36,001 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 09:39:43,456 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 09:39:43,457 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 09:39:43,457 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 09:43:17,549 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 09:43:17,552 - __main__ - INFO - Processed pearson correlation matrix to series with 1359576585 values (dtype: float16)
2025-07-03 09:43:17,565 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 09:43:17,565 - __main__ - INFO -   Original shape: (1359576585,)
2025-07-03 09:43:17,565 - __main__ - INFO -   Data type: float16
2025-07-03 09:43:26,056 - __main__ - INFO -   Memory usage: 12977.92 MB
2025-07-03 09:49:55,011 - __main__ - INFO - Alignment summary:
2025-07-03 09:49:55,011 - __main__ - INFO -   Aligned shape: (1359576585,)
2025-07-03 09:49:55,011 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 09:50:03,524 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 09:50:03,524 - __main__ - INFO - Caching aligned pearson matrix for brain_frontal_cortex_ba9:
2025-07-03 09:50:03,524 - __main__ - INFO -   Shape: (1359576585,)
2025-07-03 09:50:03,524 - __main__ - INFO -   Data type: float16
2025-07-03 09:50:03,531 - __main__ - INFO -   Memory usage: 12977.92 MB
2025-07-03 09:50:11,738 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 09:50:35,760 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 09:50:35,760 - __main__ - INFO -   First 5 values:
2025-07-03 09:50:35,761 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.034760
2025-07-03 09:50:35,762 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.045654
2025-07-03 09:50:35,762 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.076233
2025-07-03 09:50:35,762 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000134184.12'): 0.037628
2025-07-03 09:50:35,762 - __main__ - INFO -     ('ENSG00000173110.7', 'ENSG00000129824.15'): 0.016953
2025-07-03 09:50:35,762 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 09:50:35,762 - __main__ - INFO -   Index names: [None, None]
2025-07-03 09:56:09,627 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_brain_frontal_cortex_ba9_var_pc_log2.pkl
2025-07-03 09:56:09,627 - __main__ - INFO -   Cache file size: 23340.03 MB
2025-07-03 09:56:09,902 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 09:56:13,002 - __main__ - INFO - Got aligned pearson series for brain_frontal_cortex_ba9 with 1359576585 values
2025-07-03 09:56:13,002 - __main__ - INFO - Combining 1359576585 gene pairs for brain_frontal_cortex_ba9
2025-07-03 10:02:32,049 - __main__ - INFO - Successfully combined correlations for brain_frontal_cortex_ba9 into DataFrame with shape: (1359576585, 3)
2025-07-03 10:02:32,049 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 18164.3MB
2025-07-03 10:02:32,493 - __main__ - INFO - Saving combined correlations for brain_frontal_cortex_ba9 to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_frontal_cortex_ba9-var_pc_log2-all.pkl
2025-07-03 10:02:32,493 - __main__ - INFO - Saving DataFrame with shape: (1359576585, 3), memory: 18164.3MB
2025-07-03 10:02:32,493 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 10:04:23,963 - __main__ - INFO - Results saved successfully. File size: 18153.7MB
2025-07-03 10:04:23,963 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 10:04:23,963 - __main__ - INFO - Successfully processed tissue: brain_frontal_cortex_ba9
2025-07-03 10:04:23,963 - __main__ - INFO - Processing tissue: brain_hippocampus
2025-07-03 10:04:23,964 - __main__ - INFO - All input files validated successfully for brain_hippocampus
2025-07-03 10:04:23,964 - __main__ - INFO - Starting correlation combination process for brain_hippocampus
2025-07-03 10:04:23,964 - __main__ - INFO - Loading gene expression data for brain_hippocampus from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_hippocampus-var_pc_log2.pkl
2025-07-03 10:04:24,336 - __main__ - INFO - Loaded gene expression data for brain_hippocampus with shape: (56200, 197)
2025-07-03 10:04:24,336 - __main__ - INFO - Need to load and process for brain_hippocampus: ccc_gpu, pearson, spearman
2025-07-03 10:04:24,336 - __main__ - INFO - No cache found for spearman in brain_hippocampus, loading and processing matrix
2025-07-03 10:04:24,337 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_hippocampus-var_pc_log2-spearman.pkl
2025-07-03 10:04:48,753 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 10:04:56,126 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 10:04:56,127 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 10:04:56,128 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 10:06:31,399 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 10:06:31,399 - __main__ - INFO - Processed spearman correlation matrix to series with 1381565895 values (dtype: float16)
2025-07-03 10:06:31,412 - __main__ - INFO - Processed spearman matrix for brain_hippocampus (reference):
2025-07-03 10:06:31,412 - __main__ - INFO -   Shape: (1381565895,)
2025-07-03 10:06:31,412 - __main__ - INFO -   Data type: float16
2025-07-03 10:06:40,043 - __main__ - INFO -   Memory usage: 13187.63 MB
2025-07-03 10:06:40,044 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 10:06:40,044 - __main__ - INFO - Caching aligned spearman matrix for brain_hippocampus:
2025-07-03 10:06:40,044 - __main__ - INFO -   Shape: (1381565895,)
2025-07-03 10:06:40,044 - __main__ - INFO -   Data type: float16
2025-07-03 10:06:40,050 - __main__ - INFO -   Memory usage: 13187.63 MB
2025-07-03 10:06:48,404 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 10:07:11,614 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 10:07:11,614 - __main__ - INFO -   First 5 values:
2025-07-03 10:07:11,615 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.097839
2025-07-03 10:07:11,615 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000134184.12'): 0.036285
2025-07-03 10:07:11,615 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000129824.15'): 0.021820
2025-07-03 10:07:11,615 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000134184.12'): 0.074280
2025-07-03 10:07:11,615 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.025986
2025-07-03 10:07:11,615 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 10:07:11,615 - __main__ - INFO -   Index names: [None, None]
2025-07-03 10:10:53,490 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_hippocampus_var_pc_log2.pkl
2025-07-03 10:10:53,490 - __main__ - INFO -   Cache file size: 23717.50 MB
2025-07-03 10:10:53,766 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 10:10:53,766 - __main__ - INFO - Using Spearman indices as reference for brain_hippocampus: 1381565895 gene pairs
2025-07-03 10:10:53,766 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 10:10:53,766 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_hippocampus-var_pc_log2-ccc_gpu.pkl
2025-07-03 10:11:26,927 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 10:11:40,983 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 10:11:40,985 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 10:11:40,985 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 10:14:31,289 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578324056 values (dtype: float16)
2025-07-03 10:14:31,303 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 10:14:31,304 - __main__ - INFO -   Original shape: (1578324056,)
2025-07-03 10:14:31,304 - __main__ - INFO -   Data type: float16
2025-07-03 10:14:41,192 - __main__ - INFO -   Memory usage: 15064.06 MB
2025-07-03 10:21:16,239 - __main__ - INFO - Alignment summary:
2025-07-03 10:21:16,239 - __main__ - INFO -   Aligned shape: (1381565895,)
2025-07-03 10:21:16,239 - __main__ - INFO -   Alignment ratio: 87.53% of original
2025-07-03 10:21:24,924 - __main__ - INFO -   Memory saved: 34900.43 MB
2025-07-03 10:21:24,924 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_hippocampus:
2025-07-03 10:21:24,924 - __main__ - INFO -   Shape: (1381565895,)
2025-07-03 10:21:24,924 - __main__ - INFO -   Data type: float16
2025-07-03 10:21:24,930 - __main__ - INFO -   Memory usage: 13187.63 MB
2025-07-03 10:21:33,333 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 10:22:24,202 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 10:22:24,202 - __main__ - INFO -   First 5 values:
2025-07-03 10:22:24,203 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.025360
2025-07-03 10:22:24,203 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000134184.12'): 0.010353
2025-07-03 10:22:24,203 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000129824.15'): 0.020569
2025-07-03 10:22:24,203 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000134184.12'): 0.023422
2025-07-03 10:22:24,203 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.039398
2025-07-03 10:22:24,203 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 10:22:24,203 - __main__ - INFO -   Index names: [None, None]
2025-07-03 10:32:42,726 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_brain_hippocampus_var_pc_log2.pkl
2025-07-03 10:32:42,726 - __main__ - INFO -   Cache file size: 23717.50 MB
2025-07-03 10:32:42,993 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 10:32:45,921 - __main__ - INFO - Got aligned ccc_gpu series for brain_hippocampus with 1381565895 values
2025-07-03 10:32:45,922 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 10:32:45,922 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_hippocampus-var_pc_log2-pearson.pkl
2025-07-03 10:33:13,504 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 10:33:21,132 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 10:33:21,133 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 10:33:21,134 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 10:36:53,777 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 10:36:53,780 - __main__ - INFO - Processed pearson correlation matrix to series with 1381565895 values (dtype: float16)
2025-07-03 10:36:53,793 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 10:36:53,793 - __main__ - INFO -   Original shape: (1381565895,)
2025-07-03 10:36:53,793 - __main__ - INFO -   Data type: float16
2025-07-03 10:37:02,326 - __main__ - INFO -   Memory usage: 13187.63 MB
2025-07-03 10:43:33,013 - __main__ - INFO - Alignment summary:
2025-07-03 10:43:33,013 - __main__ - INFO -   Aligned shape: (1381565895,)
2025-07-03 10:43:33,013 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 10:43:41,590 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 10:43:41,590 - __main__ - INFO - Caching aligned pearson matrix for brain_hippocampus:
2025-07-03 10:43:41,590 - __main__ - INFO -   Shape: (1381565895,)
2025-07-03 10:43:41,590 - __main__ - INFO -   Data type: float16
2025-07-03 10:43:41,597 - __main__ - INFO -   Memory usage: 13187.63 MB
2025-07-03 10:43:49,927 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 10:44:14,292 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 10:44:14,292 - __main__ - INFO -   First 5 values:
2025-07-03 10:44:14,294 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.100037
2025-07-03 10:44:14,294 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000134184.12'): 0.084167
2025-07-03 10:44:14,294 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000129824.15'): 0.058502
2025-07-03 10:44:14,294 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000134184.12'): 0.045258
2025-07-03 10:44:14,294 - __main__ - INFO -     ('ENSG00000224114.1', 'ENSG00000129824.15'): 0.037384
2025-07-03 10:44:14,294 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 10:44:14,294 - __main__ - INFO -   Index names: [None, None]
2025-07-03 10:48:14,590 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_brain_hippocampus_var_pc_log2.pkl
2025-07-03 10:48:14,590 - __main__ - INFO -   Cache file size: 23717.50 MB
2025-07-03 10:48:14,859 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 10:48:17,947 - __main__ - INFO - Got aligned pearson series for brain_hippocampus with 1381565895 values
2025-07-03 10:48:17,947 - __main__ - INFO - Combining 1381565895 gene pairs for brain_hippocampus
2025-07-03 10:54:38,372 - __main__ - INFO - Successfully combined correlations for brain_hippocampus into DataFrame with shape: (1381565895, 3)
2025-07-03 10:54:38,372 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 18457.9MB
2025-07-03 10:54:38,826 - __main__ - INFO - Saving combined correlations for brain_hippocampus to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_hippocampus-var_pc_log2-all.pkl
2025-07-03 10:54:38,826 - __main__ - INFO - Saving DataFrame with shape: (1381565895, 3), memory: 18457.9MB
2025-07-03 10:54:38,826 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 10:57:39,460 - __main__ - INFO - Results saved successfully. File size: 18447.2MB
2025-07-03 10:57:39,460 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 10:57:39,460 - __main__ - INFO - Successfully processed tissue: brain_hippocampus
2025-07-03 10:57:39,460 - __main__ - INFO - Processing tissue: brain_hypothalamus
2025-07-03 10:57:39,481 - __main__ - INFO - All input files validated successfully for brain_hypothalamus
2025-07-03 10:57:39,481 - __main__ - INFO - Starting correlation combination process for brain_hypothalamus
2025-07-03 10:57:39,482 - __main__ - INFO - Loading gene expression data for brain_hypothalamus from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_hypothalamus-var_pc_log2.pkl
2025-07-03 10:57:40,549 - __main__ - INFO - Loaded gene expression data for brain_hypothalamus with shape: (56200, 202)
2025-07-03 10:57:40,549 - __main__ - INFO - Need to load and process for brain_hypothalamus: ccc_gpu, pearson, spearman
2025-07-03 10:57:40,550 - __main__ - INFO - No cache found for spearman in brain_hypothalamus, loading and processing matrix
2025-07-03 10:57:40,550 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_hypothalamus-var_pc_log2-spearman.pkl
2025-07-03 10:58:09,406 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 10:58:16,989 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 10:58:16,990 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 10:58:16,990 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 10:59:54,717 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 10:59:54,719 - __main__ - INFO - Processed spearman correlation matrix to series with 1371020430 values (dtype: float16)
2025-07-03 10:59:54,733 - __main__ - INFO - Processed spearman matrix for brain_hypothalamus (reference):
2025-07-03 10:59:54,733 - __main__ - INFO -   Shape: (1371020430,)
2025-07-03 10:59:54,733 - __main__ - INFO -   Data type: float16
2025-07-03 11:00:03,195 - __main__ - INFO -   Memory usage: 13087.06 MB
2025-07-03 11:00:03,195 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 11:00:03,195 - __main__ - INFO - Caching aligned spearman matrix for brain_hypothalamus:
2025-07-03 11:00:03,195 - __main__ - INFO -   Shape: (1371020430,)
2025-07-03 11:00:03,195 - __main__ - INFO -   Data type: float16
2025-07-03 11:00:03,201 - __main__ - INFO -   Memory usage: 13087.06 MB
2025-07-03 11:00:11,197 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 11:00:33,398 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 11:00:33,398 - __main__ - INFO -   First 5 values:
2025-07-03 11:00:33,398 - __main__ - INFO -     ('ENSG00000101405.3', 'ENSG00000101200.5'): 0.938965
2025-07-03 11:00:33,398 - __main__ - INFO -     ('ENSG00000183395.4', 'ENSG00000101200.5'): 0.017975
2025-07-03 11:00:33,398 - __main__ - INFO -     ('ENSG00000183395.4', 'ENSG00000101405.3'): 0.067383
2025-07-03 11:00:33,398 - __main__ - INFO -     ('ENSG00000161610.1', 'ENSG00000101200.5'): 0.250244
2025-07-03 11:00:33,398 - __main__ - INFO -     ('ENSG00000161610.1', 'ENSG00000101405.3'): 0.330322
2025-07-03 11:00:33,398 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 11:00:33,399 - __main__ - INFO -   Index names: [None, None]
2025-07-03 11:03:55,251 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_hypothalamus_var_pc_log2.pkl
2025-07-03 11:03:55,252 - __main__ - INFO -   Cache file size: 23536.48 MB
2025-07-03 11:03:55,507 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 11:03:55,507 - __main__ - INFO - Using Spearman indices as reference for brain_hypothalamus: 1371020430 gene pairs
2025-07-03 11:03:55,507 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 11:03:55,507 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_hypothalamus-var_pc_log2-ccc_gpu.pkl
2025-07-03 11:05:13,174 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 11:05:27,710 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 11:05:27,711 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 11:05:27,711 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 11:08:16,901 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578271345 values (dtype: float16)
2025-07-03 11:08:16,916 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 11:08:16,916 - __main__ - INFO -   Original shape: (1578271345,)
2025-07-03 11:08:16,917 - __main__ - INFO -   Data type: float16
2025-07-03 11:08:26,599 - __main__ - INFO -   Memory usage: 15063.56 MB
2025-07-03 11:15:03,679 - __main__ - INFO - Alignment summary:
2025-07-03 11:15:03,679 - __main__ - INFO -   Aligned shape: (1371020430,)
2025-07-03 11:15:03,679 - __main__ - INFO -   Alignment ratio: 86.87% of original
2025-07-03 11:15:12,094 - __main__ - INFO -   Memory saved: 35000.50 MB
2025-07-03 11:15:12,095 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_hypothalamus:
2025-07-03 11:15:12,095 - __main__ - INFO -   Shape: (1371020430,)
2025-07-03 11:15:12,095 - __main__ - INFO -   Data type: float16
2025-07-03 11:15:12,101 - __main__ - INFO -   Memory usage: 13087.06 MB
2025-07-03 11:15:20,442 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 11:16:10,304 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 11:16:10,305 - __main__ - INFO -   First 5 values:
2025-07-03 11:16:10,305 - __main__ - INFO -     ('ENSG00000101405.3', 'ENSG00000101200.5'): 0.884277
2025-07-03 11:16:10,305 - __main__ - INFO -     ('ENSG00000183395.4', 'ENSG00000101200.5'): 0.064453
2025-07-03 11:16:10,305 - __main__ - INFO -     ('ENSG00000183395.4', 'ENSG00000101405.3'): 0.058563
2025-07-03 11:16:10,305 - __main__ - INFO -     ('ENSG00000161610.1', 'ENSG00000101200.5'): 0.051086
2025-07-03 11:16:10,305 - __main__ - INFO -     ('ENSG00000161610.1', 'ENSG00000101405.3'): 0.062500
2025-07-03 11:16:10,305 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 11:16:10,305 - __main__ - INFO -   Index names: [None, None]
2025-07-03 11:20:54,746 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_brain_hypothalamus_var_pc_log2.pkl
2025-07-03 11:20:54,746 - __main__ - INFO -   Cache file size: 23536.48 MB
2025-07-03 11:20:55,014 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 11:20:58,044 - __main__ - INFO - Got aligned ccc_gpu series for brain_hypothalamus with 1371020430 values
2025-07-03 11:20:58,045 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 11:20:58,045 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_hypothalamus-var_pc_log2-pearson.pkl
2025-07-03 11:22:15,726 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 11:22:23,165 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 11:22:23,167 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 11:22:23,167 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 11:25:55,584 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 11:25:55,586 - __main__ - INFO - Processed pearson correlation matrix to series with 1371020430 values (dtype: float16)
2025-07-03 11:25:55,598 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 11:25:55,599 - __main__ - INFO -   Original shape: (1371020430,)
2025-07-03 11:25:55,599 - __main__ - INFO -   Data type: float16
2025-07-03 11:26:04,070 - __main__ - INFO -   Memory usage: 13087.06 MB
2025-07-03 11:32:36,050 - __main__ - INFO - Alignment summary:
2025-07-03 11:32:36,050 - __main__ - INFO -   Aligned shape: (1371020430,)
2025-07-03 11:32:36,050 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 11:32:44,429 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 11:32:44,429 - __main__ - INFO - Caching aligned pearson matrix for brain_hypothalamus:
2025-07-03 11:32:44,429 - __main__ - INFO -   Shape: (1371020430,)
2025-07-03 11:32:44,429 - __main__ - INFO -   Data type: float16
2025-07-03 11:32:44,435 - __main__ - INFO -   Memory usage: 13087.06 MB
2025-07-03 11:32:52,708 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 11:33:16,870 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 11:33:16,871 - __main__ - INFO -   First 5 values:
2025-07-03 11:33:16,873 - __main__ - INFO -     ('ENSG00000101405.3', 'ENSG00000101200.5'): 0.667969
2025-07-03 11:33:16,873 - __main__ - INFO -     ('ENSG00000183395.4', 'ENSG00000101200.5'): 0.105530
2025-07-03 11:33:16,873 - __main__ - INFO -     ('ENSG00000183395.4', 'ENSG00000101405.3'): 0.106384
2025-07-03 11:33:16,873 - __main__ - INFO -     ('ENSG00000161610.1', 'ENSG00000101200.5'): 0.091492
2025-07-03 11:33:16,873 - __main__ - INFO -     ('ENSG00000161610.1', 'ENSG00000101405.3'): 0.065613
2025-07-03 11:33:16,873 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 11:33:16,873 - __main__ - INFO -   Index names: [None, None]
2025-07-03 11:35:46,496 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_brain_hypothalamus_var_pc_log2.pkl
2025-07-03 11:35:46,496 - __main__ - INFO -   Cache file size: 23536.48 MB
2025-07-03 11:35:46,766 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 11:35:49,819 - __main__ - INFO - Got aligned pearson series for brain_hypothalamus with 1371020430 values
2025-07-03 11:35:49,819 - __main__ - INFO - Combining 1371020430 gene pairs for brain_hypothalamus
2025-07-03 11:42:08,917 - __main__ - INFO - Successfully combined correlations for brain_hypothalamus into DataFrame with shape: (1371020430, 3)
2025-07-03 11:42:08,917 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 18317.1MB
2025-07-03 11:42:09,357 - __main__ - INFO - Saving combined correlations for brain_hypothalamus to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_hypothalamus-var_pc_log2-all.pkl
2025-07-03 11:42:09,357 - __main__ - INFO - Saving DataFrame with shape: (1371020430, 3), memory: 18317.1MB
2025-07-03 11:42:09,357 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 11:44:02,843 - __main__ - INFO - Results saved successfully. File size: 18306.5MB
2025-07-03 11:44:02,843 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 11:44:02,843 - __main__ - INFO - Successfully processed tissue: brain_hypothalamus
2025-07-03 11:44:02,843 - __main__ - INFO - Processing tissue: brain_nucleus_accumbens_basal_ganglia
2025-07-03 11:44:02,845 - __main__ - INFO - All input files validated successfully for brain_nucleus_accumbens_basal_ganglia
2025-07-03 11:44:02,845 - __main__ - INFO - Starting correlation combination process for brain_nucleus_accumbens_basal_ganglia
2025-07-03 11:44:02,845 - __main__ - INFO - Loading gene expression data for brain_nucleus_accumbens_basal_ganglia from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_nucleus_accumbens_basal_ganglia-var_pc_log2.pkl
2025-07-03 11:44:03,229 - __main__ - INFO - Loaded gene expression data for brain_nucleus_accumbens_basal_ganglia with shape: (56200, 246)
2025-07-03 11:44:03,229 - __main__ - INFO - Need to load and process for brain_nucleus_accumbens_basal_ganglia: ccc_gpu, pearson, spearman
2025-07-03 11:44:03,229 - __main__ - INFO - No cache found for spearman in brain_nucleus_accumbens_basal_ganglia, loading and processing matrix
2025-07-03 11:44:03,229 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_nucleus_accumbens_basal_ganglia-var_pc_log2-spearman.pkl
2025-07-03 11:44:27,374 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 11:44:34,866 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 11:44:34,867 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 11:44:34,867 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 11:46:20,692 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 11:46:20,692 - __main__ - INFO - Processed spearman correlation matrix to series with 1389198405 values (dtype: float16)
2025-07-03 11:46:20,707 - __main__ - INFO - Processed spearman matrix for brain_nucleus_accumbens_basal_ganglia (reference):
2025-07-03 11:46:20,707 - __main__ - INFO -   Shape: (1389198405,)
2025-07-03 11:46:20,707 - __main__ - INFO -   Data type: float16
2025-07-03 11:46:29,288 - __main__ - INFO -   Memory usage: 13260.42 MB
2025-07-03 11:46:29,288 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 11:46:29,288 - __main__ - INFO - Caching aligned spearman matrix for brain_nucleus_accumbens_basal_ganglia:
2025-07-03 11:46:29,288 - __main__ - INFO -   Shape: (1389198405,)
2025-07-03 11:46:29,288 - __main__ - INFO -   Data type: float16
2025-07-03 11:46:29,295 - __main__ - INFO -   Memory usage: 13260.42 MB
2025-07-03 11:46:37,673 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 11:47:01,256 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 11:47:01,256 - __main__ - INFO -   First 5 values:
2025-07-03 11:47:01,256 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.176270
2025-07-03 11:47:01,256 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.107727
2025-07-03 11:47:01,256 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.080261
2025-07-03 11:47:01,257 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000134184.12'): 0.243408
2025-07-03 11:47:01,257 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000129824.15'): 0.406006
2025-07-03 11:47:01,257 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 11:47:01,257 - __main__ - INFO -   Index names: [None, None]
2025-07-03 11:51:35,359 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_nucleus_accumbens_basal_ganglia_var_pc_log2.pkl
2025-07-03 11:51:35,359 - __main__ - INFO -   Cache file size: 23848.52 MB
2025-07-03 11:51:35,624 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 11:51:35,624 - __main__ - INFO - Using Spearman indices as reference for brain_nucleus_accumbens_basal_ganglia: 1389198405 gene pairs
2025-07-03 11:51:35,624 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 11:51:35,624 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_nucleus_accumbens_basal_ganglia-var_pc_log2-ccc_gpu.pkl
2025-07-03 11:52:05,014 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 11:52:21,917 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 11:52:21,919 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 11:52:21,919 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 11:55:25,362 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578361641 values (dtype: float16)
2025-07-03 11:55:25,377 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 11:55:25,377 - __main__ - INFO -   Original shape: (1578361641,)
2025-07-03 11:55:25,377 - __main__ - INFO -   Data type: float16
2025-07-03 11:55:35,085 - __main__ - INFO -   Memory usage: 15064.42 MB
2025-07-03 12:02:18,652 - __main__ - INFO - Alignment summary:
2025-07-03 12:02:18,652 - __main__ - INFO -   Aligned shape: (1389198405,)
2025-07-03 12:02:18,652 - __main__ - INFO -   Alignment ratio: 88.02% of original
2025-07-03 12:02:27,220 - __main__ - INFO -   Memory saved: 34828.00 MB
2025-07-03 12:02:27,220 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_nucleus_accumbens_basal_ganglia:
2025-07-03 12:02:27,220 - __main__ - INFO -   Shape: (1389198405,)
2025-07-03 12:02:27,220 - __main__ - INFO -   Data type: float16
2025-07-03 12:02:27,227 - __main__ - INFO -   Memory usage: 13260.42 MB
2025-07-03 12:02:35,683 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 12:03:27,317 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 12:03:27,317 - __main__ - INFO -   First 5 values:
2025-07-03 12:03:27,317 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.026581
2025-07-03 12:03:27,317 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.017517
2025-07-03 12:03:27,317 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.023499
2025-07-03 12:03:27,317 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000134184.12'): 0.030533
2025-07-03 12:03:27,317 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000129824.15'): 0.211548
2025-07-03 12:03:27,317 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 12:03:27,317 - __main__ - INFO -   Index names: [None, None]
2025-07-03 12:06:54,112 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_ccc_gpu_brain_nucleus_accumbens_basal_ganglia_var_pc_log2.pkl
2025-07-03 12:06:54,112 - __main__ - INFO -   Cache file size: 23848.52 MB
2025-07-03 12:06:54,385 - __main__ - INFO -   Freed 6030.24 MB by deleting original ccc_gpu correlation matrix from memory
2025-07-03 12:06:57,491 - __main__ - INFO - Got aligned ccc_gpu series for brain_nucleus_accumbens_basal_ganglia with 1389198405 values
2025-07-03 12:06:57,491 - __main__ - INFO - No cache found for pearson, loading, processing and aligning matrix
2025-07-03 12:06:57,491 - __main__ - INFO - Loading pearson correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_nucleus_accumbens_basal_ganglia-var_pc_log2-pearson.pkl
2025-07-03 12:07:26,599 - __main__ - INFO - Converting pearson matrix from float32 to float16 for memory optimization
2025-07-03 12:07:34,278 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 12:07:34,279 - __main__ - INFO - Loaded pearson correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 12:07:34,280 - __main__ - INFO - Processing pearson correlation matrix (dtype: float16)
2025-07-03 12:11:07,794 - __main__ - INFO - Applied absolute value to pearson correlations (maintaining float16)
2025-07-03 12:11:07,795 - __main__ - INFO - Processed pearson correlation matrix to series with 1389198405 values (dtype: float16)
2025-07-03 12:11:07,810 - __main__ - INFO - Processed pearson matrix before alignment:
2025-07-03 12:11:07,810 - __main__ - INFO -   Original shape: (1389198405,)
2025-07-03 12:11:07,810 - __main__ - INFO -   Data type: float16
2025-07-03 12:11:16,390 - __main__ - INFO -   Memory usage: 13260.42 MB
2025-07-03 12:17:48,205 - __main__ - INFO - Alignment summary:
2025-07-03 12:17:48,205 - __main__ - INFO -   Aligned shape: (1389198405,)
2025-07-03 12:17:48,205 - __main__ - INFO -   Alignment ratio: 100.00% of original
2025-07-03 12:17:56,780 - __main__ - INFO -   Memory saved: 33024.00 MB
2025-07-03 12:17:56,781 - __main__ - INFO - Caching aligned pearson matrix for brain_nucleus_accumbens_basal_ganglia:
2025-07-03 12:17:56,781 - __main__ - INFO -   Shape: (1389198405,)
2025-07-03 12:17:56,781 - __main__ - INFO -   Data type: float16
2025-07-03 12:17:56,787 - __main__ - INFO -   Memory usage: 13260.42 MB
2025-07-03 12:18:05,172 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 12:18:29,884 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 12:18:29,884 - __main__ - INFO -   First 5 values:
2025-07-03 12:18:29,886 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.123047
2025-07-03 12:18:29,886 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.041321
2025-07-03 12:18:29,886 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000129824.15'): 0.017181
2025-07-03 12:18:29,886 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000134184.12'): 0.218872
2025-07-03 12:18:29,886 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000129824.15'): 0.326416
2025-07-03 12:18:29,886 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 12:18:29,886 - __main__ - INFO -   Index names: [None, None]
2025-07-03 12:22:49,501 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_pearson_brain_nucleus_accumbens_basal_ganglia_var_pc_log2.pkl
2025-07-03 12:22:49,502 - __main__ - INFO -   Cache file size: 23848.52 MB
2025-07-03 12:22:49,741 - __main__ - INFO -   Freed 6030.24 MB by deleting original pearson correlation matrix from memory
2025-07-03 12:22:52,769 - __main__ - INFO - Got aligned pearson series for brain_nucleus_accumbens_basal_ganglia with 1389198405 values
2025-07-03 12:22:52,769 - __main__ - INFO - Combining 1389198405 gene pairs for brain_nucleus_accumbens_basal_ganglia
2025-07-03 12:29:16,732 - __main__ - INFO - Successfully combined correlations for brain_nucleus_accumbens_basal_ganglia into DataFrame with shape: (1389198405, 3)
2025-07-03 12:29:16,732 - __main__ - INFO - Final DataFrame dtype: float16, memory usage: 18559.8MB
2025-07-03 12:29:17,176 - __main__ - INFO - Saving combined correlations for brain_nucleus_accumbens_basal_ganglia to /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_nucleus_accumbens_basal_ganglia-var_pc_log2-all.pkl
2025-07-03 12:29:17,177 - __main__ - INFO - Saving DataFrame with shape: (1389198405, 3), memory: 18559.8MB
2025-07-03 12:29:17,177 - __main__ - INFO - Data types: ccc: float16, pearson: float16, spearman: float16
2025-07-03 12:32:27,510 - __main__ - INFO - Results saved successfully. File size: 18549.2MB
2025-07-03 12:32:27,510 - __main__ - INFO - Memory optimization: Using float16 reduces memory usage by ~50% compared to float32
2025-07-03 12:32:27,510 - __main__ - INFO - Successfully processed tissue: brain_nucleus_accumbens_basal_ganglia
2025-07-03 12:32:27,510 - __main__ - INFO - Processing tissue: brain_putamen_basal_ganglia
2025-07-03 12:32:27,553 - __main__ - INFO - All input files validated successfully for brain_putamen_basal_ganglia
2025-07-03 12:32:27,553 - __main__ - INFO - Starting correlation combination process for brain_putamen_basal_ganglia
2025-07-03 12:32:27,553 - __main__ - INFO - Loading gene expression data for brain_putamen_basal_ganglia from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_putamen_basal_ganglia-var_pc_log2.pkl
2025-07-03 12:32:28,385 - __main__ - INFO - Loaded gene expression data for brain_putamen_basal_ganglia with shape: (56200, 205)
2025-07-03 12:32:28,385 - __main__ - INFO - Need to load and process for brain_putamen_basal_ganglia: ccc_gpu, pearson, spearman
2025-07-03 12:32:28,385 - __main__ - INFO - No cache found for spearman in brain_putamen_basal_ganglia, loading and processing matrix
2025-07-03 12:32:28,385 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_putamen_basal_ganglia-var_pc_log2-spearman.pkl
2025-07-03 12:32:58,037 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 12:33:05,622 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 12:33:05,623 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 12:33:05,624 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 12:34:45,964 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 12:34:45,964 - __main__ - INFO - Processed spearman correlation matrix to series with 1336936195 values (dtype: float16)
2025-07-03 12:34:45,977 - __main__ - INFO - Processed spearman matrix for brain_putamen_basal_ganglia (reference):
2025-07-03 12:34:45,977 - __main__ - INFO -   Shape: (1336936195,)
2025-07-03 12:34:45,977 - __main__ - INFO -   Data type: float16
2025-07-03 12:34:54,268 - __main__ - INFO -   Memory usage: 12762.01 MB
2025-07-03 12:34:54,268 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 12:34:54,268 - __main__ - INFO - Caching aligned spearman matrix for brain_putamen_basal_ganglia:
2025-07-03 12:34:54,268 - __main__ - INFO -   Shape: (1336936195,)
2025-07-03 12:34:54,268 - __main__ - INFO -   Data type: float16
2025-07-03 12:34:54,275 - __main__ - INFO -   Memory usage: 12762.01 MB
2025-07-03 12:35:02,372 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 12:35:25,152 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 12:35:25,153 - __main__ - INFO -   First 5 values:
2025-07-03 12:35:25,153 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000134184.12'): 0.271240
2025-07-03 12:35:25,153 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.160400
2025-07-03 12:35:25,153 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000181195.10'): 0.590332
2025-07-03 12:35:25,153 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.038879
2025-07-03 12:35:25,153 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000181195.10'): 0.116272
2025-07-03 12:35:25,153 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 12:35:25,153 - __main__ - INFO -   Index names: [None, None]
2025-07-03 12:41:42,630 - __main__ - INFO -   Cached to: /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data-var_pc_log2-cache/aligned_spearman_brain_putamen_basal_ganglia_var_pc_log2.pkl
2025-07-03 12:41:42,630 - __main__ - INFO -   Cache file size: 22951.38 MB
2025-07-03 12:41:42,907 - __main__ - INFO -   Freed 6030.24 MB by deleting original spearman correlation matrix from memory
2025-07-03 12:41:42,908 - __main__ - INFO - Using Spearman indices as reference for brain_putamen_basal_ganglia: 1336936195 gene pairs
2025-07-03 12:41:42,908 - __main__ - INFO - No cache found for ccc_gpu, loading, processing and aligning matrix
2025-07-03 12:41:42,908 - __main__ - INFO - Loading ccc_gpu correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_putamen_basal_ganglia-var_pc_log2-ccc_gpu.pkl
2025-07-03 12:42:54,338 - __main__ - INFO - Converting ccc_gpu matrix from float32 to float16 for memory optimization
2025-07-03 12:43:08,055 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 12:43:08,057 - __main__ - INFO - Loaded ccc_gpu correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 12:43:08,057 - __main__ - INFO - Processing ccc_gpu correlation matrix (dtype: float16)
2025-07-03 12:46:18,031 - __main__ - INFO - Processed ccc_gpu correlation matrix to series with 1578094560 values (dtype: float16)
2025-07-03 12:46:18,047 - __main__ - INFO - Processed ccc_gpu matrix before alignment:
2025-07-03 12:46:18,047 - __main__ - INFO -   Original shape: (1578094560,)
2025-07-03 12:46:18,047 - __main__ - INFO -   Data type: float16
2025-07-03 12:46:27,815 - __main__ - INFO -   Memory usage: 15061.87 MB
2025-07-03 12:52:56,116 - __main__ - INFO - Alignment summary:
2025-07-03 12:52:56,117 - __main__ - INFO -   Aligned shape: (1336936195,)
2025-07-03 12:52:56,117 - __main__ - INFO -   Alignment ratio: 84.72% of original
2025-07-03 12:53:04,340 - __main__ - INFO -   Memory saved: 35323.87 MB
2025-07-03 12:53:04,340 - __main__ - INFO - Caching aligned ccc_gpu matrix for brain_putamen_basal_ganglia:
2025-07-03 12:53:04,340 - __main__ - INFO -   Shape: (1336936195,)
2025-07-03 12:53:04,341 - __main__ - INFO -   Data type: float16
2025-07-03 12:53:04,347 - __main__ - INFO -   Memory usage: 12762.01 MB
2025-07-03 12:53:12,487 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 12:54:01,291 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 12:54:01,291 - __main__ - INFO -   First 5 values:
2025-07-03 12:54:01,292 - __main__ - INFO -     ('ENSG00000181195.10', 'ENSG00000134184.12'): 0.055145
2025-07-03 12:54:01,292 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000134184.12'): 0.016373
2025-07-03 12:54:01,292 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000181195.10'): 0.313721
2025-07-03 12:54:01,292 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000134184.12'): 0.009422
2025-07-03 12:54:01,292 - __main__ - INFO -     ('ENSG00000196136.17', 'ENSG00000181195.10'): 0.034088
2025-07-03 12:54:01,292 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 12:54:01,292 - __main__ - INFO -   Index names: [None, None]
2025-07-03 12:59:04,891 - __main__ - ERROR - Error processing tissue brain_putamen_basal_ganglia: [Errno 28] No space left on device
2025-07-03 12:59:08,180 - __main__ - INFO - Processing tissue: brain_spinal_cord_cervical_c1
2025-07-03 12:59:08,184 - __main__ - INFO - All input files validated successfully for brain_spinal_cord_cervical_c1
2025-07-03 12:59:08,184 - __main__ - INFO - Starting correlation combination process for brain_spinal_cord_cervical_c1
2025-07-03 12:59:08,184 - __main__ - INFO - Loading gene expression data for brain_spinal_cord_cervical_c1 from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_spinal_cord_cervical_c1-var_pc_log2.pkl
2025-07-03 12:59:08,313 - __main__ - INFO - Loaded gene expression data for brain_spinal_cord_cervical_c1 with shape: (56200, 159)
2025-07-03 12:59:08,313 - __main__ - INFO - Need to load and process for brain_spinal_cord_cervical_c1: ccc_gpu, pearson, spearman
2025-07-03 12:59:08,313 - __main__ - INFO - No cache found for spearman in brain_spinal_cord_cervical_c1, loading and processing matrix
2025-07-03 12:59:08,313 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_spinal_cord_cervical_c1-var_pc_log2-spearman.pkl
2025-07-03 12:59:36,640 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 12:59:44,231 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 12:59:44,232 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 12:59:44,233 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 13:01:38,083 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 13:01:38,083 - __main__ - INFO - Processed spearman correlation matrix to series with 1305886065 values (dtype: float16)
2025-07-03 13:01:38,096 - __main__ - INFO - Processed spearman matrix for brain_spinal_cord_cervical_c1 (reference):
2025-07-03 13:01:38,096 - __main__ - INFO -   Shape: (1305886065,)
2025-07-03 13:01:38,096 - __main__ - INFO -   Data type: float16
2025-07-03 13:01:46,175 - __main__ - INFO -   Memory usage: 12465.89 MB
2025-07-03 13:01:46,175 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 13:01:46,175 - __main__ - INFO - Caching aligned spearman matrix for brain_spinal_cord_cervical_c1:
2025-07-03 13:01:46,175 - __main__ - INFO -   Shape: (1305886065,)
2025-07-03 13:01:46,175 - __main__ - INFO -   Data type: float16
2025-07-03 13:01:46,181 - __main__ - INFO -   Memory usage: 12465.89 MB
2025-07-03 13:01:54,091 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 13:02:15,767 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 13:02:15,767 - __main__ - INFO -   First 5 values:
2025-07-03 13:02:15,768 - __main__ - INFO -     ('ENSG00000157005.3', 'ENSG00000129824.15'): 0.003305
2025-07-03 13:02:15,768 - __main__ - INFO -     ('ENSG00000134184.12', 'ENSG00000129824.15'): 0.057678
2025-07-03 13:02:15,768 - __main__ - INFO -     ('ENSG00000134184.12', 'ENSG00000157005.3'): 0.108582
2025-07-03 13:02:15,768 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000129824.15'): 0.162720
2025-07-03 13:02:15,768 - __main__ - INFO -     ('ENSG00000118271.9', 'ENSG00000157005.3'): 0.189331
2025-07-03 13:02:15,768 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 13:02:15,768 - __main__ - INFO -   Index names: [None, None]
2025-07-03 13:02:15,769 - __main__ - ERROR - Error processing tissue brain_spinal_cord_cervical_c1: [Errno 28] No space left on device
2025-07-03 13:02:15,863 - __main__ - INFO - Processing tissue: brain_substantia_nigra
2025-07-03 13:02:15,863 - __main__ - INFO - All input files validated successfully for brain_substantia_nigra
2025-07-03 13:02:15,863 - __main__ - INFO - Starting correlation combination process for brain_substantia_nigra
2025-07-03 13:02:15,863 - __main__ - INFO - Loading gene expression data for brain_substantia_nigra from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_brain_substantia_nigra-var_pc_log2.pkl
2025-07-03 13:02:15,972 - __main__ - INFO - Loaded gene expression data for brain_substantia_nigra with shape: (56200, 139)
2025-07-03 13:02:15,972 - __main__ - INFO - Need to load and process for brain_substantia_nigra: ccc_gpu, pearson, spearman
2025-07-03 13:02:15,972 - __main__ - INFO - No cache found for spearman in brain_substantia_nigra, loading and processing matrix
2025-07-03 13:02:15,972 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_brain_substantia_nigra-var_pc_log2-spearman.pkl
2025-07-03 13:02:55,485 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 13:03:03,088 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 13:03:03,090 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 13:03:03,090 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
2025-07-03 13:05:07,463 - __main__ - INFO - Applied absolute value to spearman correlations (maintaining float16)
2025-07-03 13:05:07,464 - __main__ - INFO - Processed spearman correlation matrix to series with 1278940600 values (dtype: float16)
2025-07-03 13:05:07,478 - __main__ - INFO - Processed spearman matrix for brain_substantia_nigra (reference):
2025-07-03 13:05:07,478 - __main__ - INFO -   Shape: (1278940600,)
2025-07-03 13:05:07,478 - __main__ - INFO -   Data type: float16
2025-07-03 13:05:15,410 - __main__ - INFO -   Memory usage: 12208.92 MB
2025-07-03 13:05:15,410 - __main__ - INFO -   Will be used as alignment reference for other methods
2025-07-03 13:05:15,410 - __main__ - INFO - Caching aligned spearman matrix for brain_substantia_nigra:
2025-07-03 13:05:15,410 - __main__ - INFO -   Shape: (1278940600,)
2025-07-03 13:05:15,410 - __main__ - INFO -   Data type: float16
2025-07-03 13:05:15,417 - __main__ - INFO -   Memory usage: 12208.92 MB
2025-07-03 13:05:23,168 - __main__ - INFO -   Value range: [0.000000, 1.000000]
2025-07-03 13:05:44,328 - __main__ - INFO -   Mean: nan, Std: 0.000000
2025-07-03 13:05:44,328 - __main__ - INFO -   First 5 values:
2025-07-03 13:05:44,328 - __main__ - INFO -     ('ENSG00000180176.14', 'ENSG00000142319.17'): 0.974609
2025-07-03 13:05:44,328 - __main__ - INFO -     ('ENSG00000134184.12', 'ENSG00000142319.17'): 0.067017
2025-07-03 13:05:44,328 - __main__ - INFO -     ('ENSG00000134184.12', 'ENSG00000180176.14'): 0.085510
2025-07-03 13:05:44,328 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000142319.17'): 0.058289
2025-07-03 13:05:44,328 - __main__ - INFO -     ('ENSG00000129824.15', 'ENSG00000180176.14'): 0.026611
2025-07-03 13:05:44,328 - __main__ - INFO -   Index type: MultiIndex
2025-07-03 13:05:44,328 - __main__ - INFO -   Index names: [None, None]
2025-07-03 13:05:44,329 - __main__ - ERROR - Error processing tissue brain_substantia_nigra: [Errno 28] No space left on device
2025-07-03 13:05:44,416 - __main__ - INFO - Processing tissue: breast_mammary_tissue
2025-07-03 13:05:44,417 - __main__ - INFO - All input files validated successfully for breast_mammary_tissue
2025-07-03 13:05:44,418 - __main__ - INFO - Starting correlation combination process for breast_mammary_tissue
2025-07-03 13:05:44,418 - __main__ - INFO - Loading gene expression data for breast_mammary_tissue from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/gene_selection/all/gtex_v8_data_breast_mammary_tissue-var_pc_log2.pkl
2025-07-03 13:05:44,762 - __main__ - INFO - Loaded gene expression data for breast_mammary_tissue with shape: (56200, 459)
2025-07-03 13:05:44,762 - __main__ - INFO - Need to load and process for breast_mammary_tissue: ccc_gpu, pearson, spearman
2025-07-03 13:05:44,762 - __main__ - INFO - No cache found for spearman in breast_mammary_tissue, loading and processing matrix
2025-07-03 13:05:44,762 - __main__ - INFO - Loading spearman correlation matrix from /mnt/data/proj_data/ccc-gpu/gene_expr/data/gtex_v8/similarity_matrices/all/gtex_v8_data_breast_mammary_tissue-var_pc_log2-spearman.pkl
2025-07-03 13:07:56,174 - __main__ - INFO - Converting spearman matrix from float32 to float16 for memory optimization
2025-07-03 13:08:03,814 - __main__ - INFO - Memory usage: 12052.5MB → 6028.2MB (saved 6024.2MB, 50.0%)
2025-07-03 13:08:03,815 - __main__ - INFO - Loaded spearman correlation matrix with shape: (56200, 56200), dtype: float16
2025-07-03 13:08:03,815 - __main__ - INFO - Processing spearman correlation matrix (dtype: float16)
